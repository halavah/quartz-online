# 04. éƒ¨ç½²ä¸è¿ç»´

## ğŸš€ å¿«é€Ÿéƒ¨ç½²åˆ° Vercelï¼ˆæ¨èï¼‰

### æ–¹æ³• 1: é€šè¿‡ GitHub é›†æˆï¼ˆæœ€ç®€å•ï¼‰

1. **æ¨é€ä»£ç åˆ° GitHub**ï¼š
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin https://github.com/your-username/your-repo.git
   git push -u origin main
   ```

2. **åœ¨ Vercel å¯¼å…¥é¡¹ç›®**ï¼š
   - è®¿é—® [vercel.com](https://vercel.com)
   - ç‚¹å‡» "New Project"
   - å¯¼å…¥ä½ çš„ GitHub ä»“åº“
   - Vercel ä¼šè‡ªåŠ¨æ£€æµ‹ Next.js é¡¹ç›®å¹¶é…ç½®
   - ç‚¹å‡» "Deploy"

3. **é…ç½®è‡ªå®šä¹‰åŸŸå**ï¼ˆå¯é€‰ï¼‰ï¼š
   - åœ¨é¡¹ç›®è®¾ç½®ä¸­ç‚¹å‡» "Domains"
   - æ·»åŠ ä½ çš„åŸŸå
   - æŒ‰ç…§æç¤ºé…ç½® DNS

### æ–¹æ³• 2: ä½¿ç”¨ Vercel CLI

1. **å®‰è£… Vercel CLI**ï¼š
   ```bash
   npm i -g vercel
   ```

2. **ç™»å½•å¹¶éƒ¨ç½²**ï¼š
   ```bash
   vercel login
   vercel --prod
   ```

### Vercel ä¼˜åŠ¿
- âœ… é›¶é…ç½®éƒ¨ç½²
- âœ… å…¨çƒ CDN åŠ é€Ÿ
- âœ… è‡ªåŠ¨ HTTPS
- âœ… Git é›†æˆï¼Œè‡ªåŠ¨éƒ¨ç½²
- âœ… æ€§èƒ½åˆ†æ
- âœ… è¾¹ç¼˜å‡½æ•°æ”¯æŒ

---

## ğŸŒ éƒ¨ç½²åˆ° Netlify

### æ–¹æ³• 1: æ‹–æ‹½éƒ¨ç½²ï¼ˆæœ€ç®€å•ï¼‰

1. **æ„å»ºé¡¹ç›®**ï¼š
   ```bash
   npm run build
   ```

2. **éƒ¨ç½²**ï¼š
   - è®¿é—® [netlify.com](https://netlify.com)
   - æ‹–æ‹½ `out` æ–‡ä»¶å¤¹åˆ°éƒ¨ç½²åŒºåŸŸ

### æ–¹æ³• 2: Git é›†æˆéƒ¨ç½²

1. **è¿æ¥ GitHub ä»“åº“**ï¼š
   - åœ¨ Netlify æ§åˆ¶å°ç‚¹å‡» "New site from Git"
   - é€‰æ‹© GitHub
   - æˆæƒå¹¶é€‰æ‹©ä»“åº“

2. **é…ç½®æ„å»ºè®¾ç½®**ï¼š
   ```toml
   # netlify.toml
   [build]
     command = "npm run build"
     publish = "out"

   [[redirects]]
     from = "/article/*"
     to = "/article/.html"
     status = 200

   [[redirects]]
     from = "/*"
     to = "/index.html"
     status = 404
   ```

### Netlify ä¼˜åŠ¿
- âœ… å…è´¹é¢åº¦å……è¶³
- âœ… è‡ªåŠ¨ HTTPS
- âœ… è¡¨å•å¤„ç†åŠŸèƒ½
- âœ… åˆ†æ”¯é¢„è§ˆ
- âœ… æ’ä»¶ç”Ÿæ€ç³»ç»Ÿ

---

## ğŸ”§ éƒ¨ç½²åˆ°é™æ€æ–‡ä»¶æœåŠ¡å™¨

### Nginx é…ç½®

åˆ›å»º `/etc/nginx/sites-available/your-site`ï¼š

```nginx
server {
    listen 80;
    server_name yourdomain.com;
    root /var/www/html/out;
    index index.html;

    # å¤„ç†æ–‡ç« è·¯ç”±
    location /article/ {
        try_files $uri $uri/ /article/index.html;
    }

    # å¤„ç†å…¶ä»–è·¯ç”±
    location / {
        try_files $uri $uri/ /index.html;
    }

    # ç¼“å­˜é™æ€èµ„æº
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # å®‰å…¨å¤´
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;

    # å‹ç¼©
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml+rss text/javascript;
}
```

å¯ç”¨ç«™ç‚¹ï¼š
```bash
sudo ln -s /etc/nginx/sites-available/your-site /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

### Apache é…ç½®

åˆ›å»º `.htaccess`ï¼š

```apache
RewriteEngine On

# å¤„ç†æ–‡ç« è·¯ç”±
RewriteRule ^article/(.*)$ article/$1.html [L]

# å¤„ç†å…¶ä»–è·¯ç”±
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.html [L]

# ç¼“å­˜è®¾ç½®
<IfModule mod_expires.c>
    ExpiresActive on
    ExpiresByType text/css "access plus 1 year"
    ExpiresByType application/javascript "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/ico "access plus 1 year"
    ExpiresByType image/svg "access plus 1 year"
</IfModule>

# å‹ç¼©
<IfModule mod_deflate.c>
    SetOutputFilter DEFLATE
    SetEnvIfNoCase Request_URI \
        \.(?:gif|jpe?g|png)$ no-gzip dont-vary
    SetEnvIfNoCase Request_URI \
        \.(?:exe|t?gz|zip|bz2|sit|rar)$ no-gzip dont-vary
</IfModule>

# å®‰å…¨å¤´
<IfModule mod_headers.c>
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-XSS-Protection "1; mode=block"
</IfModule>
```

---

## â˜ï¸ éƒ¨ç½²åˆ°äº‘å­˜å‚¨

### AWS S3 + CloudFront

1. **åˆ›å»ºå¹¶é…ç½® S3 Bucket**ï¼š
   ```bash
   # åˆ›å»º bucket
   aws s3 mb s3://your-bucket-name

   # å¯ç”¨é™æ€ç½‘ç«™æ‰˜ç®¡
   aws s3 website s3://your-bucket-name \
     --index-document index.html \
     --error-document index.html

   # è®¾ç½® bucket ç­–ç•¥
   cat > bucket-policy.json << EOF
   {
     "Version": "2012-10-17",
     "Statement": [
       {
         "Sid": "PublicReadGetObject",
         "Effect": "Allow",
         "Principal": "*",
         "Action": "s3:GetObject",
         "Resource": "arn:aws:s3:::your-bucket-name/*"
       }
     ]
   }
   EOF

   aws s3api put-bucket-policy \
     --bucket your-bucket-name \
     --policy file://bucket-policy.json
   ```

2. **ä¸Šä¼ æ–‡ä»¶**ï¼š
   ```bash
   aws s3 sync ./out s3://your-bucket-name --delete
   ```

3. **é…ç½® CloudFront**ï¼š
   - åˆ›å»º CloudFront åˆ†é…
   - Origin Domain: é€‰æ‹© S3 bucket
   - Viewer Protocol Policy: Redirect HTTP to HTTPS
   - Custom Error Responses: 404 -> 200, /index.html

### é˜¿é‡Œäº‘ OSS + CDN

1. **å®‰è£… ossutil**ï¼š
   ```bash
   wget https://gosspublic.alicdn.com/ossutil/1.7.16/ossutil64
   chmod 755 ossutil64
   ./ossutil64 config
   ```

2. **ä¸Šä¼ æ–‡ä»¶**ï¼š
   ```bash
   ./ossutil64 cp -r ./out oss://your-bucket-name/ --update
   ```

3. **é…ç½® CDN**ï¼š
   - å¼€é€šé˜¿é‡Œäº‘ CDN
   - æ·»åŠ åŸŸåï¼Œæºç«™è®¾ç½®ä¸º OSS bucket
   - é…ç½®ç¼“å­˜è§„åˆ™

### è…¾è®¯äº‘ COS + CDN

1. **å®‰è£… COSCLI**ï¼š
   ```bash
   wget https://coscli-1253960454.cos.ap-shanghai.myqcloud.com/coscli-linux
   chmod +x coscli-linux
   ./coscli-linux config
   ```

2. **ä¸Šä¼ æ–‡ä»¶**ï¼š
   ```bash
   ./coscli-linux sync ./out cos://your-bucket-name/ --delete
   ```

3. **é…ç½® CDN**ï¼š
   - ç™»å½•è…¾è®¯äº‘ CDN æ§åˆ¶å°
   - æ·»åŠ åŠ é€ŸåŸŸå
   - æºç«™ç±»å‹è®¾ç½®ä¸º COS

---

## ğŸ“¦ éƒ¨ç½²åˆ° CDN å¹³å°

### Cloudflare Pages

1. **è¿æ¥ä»“åº“**ï¼š
   - ç™»å½• Cloudflare Dashboard
   - è¿›å…¥ Pagesï¼Œç‚¹å‡» "Create a project"
   - é€‰æ‹© "Connect to Git"

2. **é…ç½®æ„å»ºè®¾ç½®**ï¼š
   - æ„å»ºå‘½ä»¤ï¼š`npm run build`
   - è¾“å‡ºç›®å½•ï¼š`out`
   - Node.js ç‰ˆæœ¬ï¼š18 æˆ–æ›´é«˜

3. **ç¯å¢ƒå˜é‡**ï¼ˆå¯é€‰ï¼‰ï¼š
   - æ·»åŠ å¿…è¦çš„ç¯å¢ƒå˜é‡

4. **éƒ¨ç½²**ï¼š
   - ç‚¹å‡» "Save and Deploy"
   - æ¯æ¬¡æ¨é€åˆ°ä¸»åˆ†æ”¯ä¼šè‡ªåŠ¨éƒ¨ç½²

### GitHub Pages

1. **ä¿®æ”¹ next.config.ts**ï¼š
   ```typescript
   const nextConfig = {
     output: 'export',
     images: {
       unoptimized: true
     },
     basePath: '/repo-name', // å¦‚æœéƒ¨ç½²åˆ°å­ç›®å½•
     trailingSlash: true,
     assetPrefix: '/repo-name',
     // ç¦ç”¨å›¾ç‰‡ä¼˜åŒ–
     experimental: {
       images: {
         unoptimized: true
       }
     }
   };
   ```

2. **åˆ›å»º GitHub Actions å·¥ä½œæµ**ï¼š
   åˆ›å»º `.github/workflows/deploy.yml`ï¼š
   ```yaml
   name: Deploy to GitHub Pages

   on:
     push:
       branches: [ main ]
     pull_request:
       branches: [ main ]

   jobs:
     build-and-deploy:
       runs-on: ubuntu-latest
       steps:
       - name: Checkout
         uses: actions/checkout@v4

       - name: Setup Node.js
         uses: actions/setup-node@v4
         with:
           node-version: '18'
           cache: 'npm'

       - name: Install dependencies
         run: npm ci

       - name: Build
         run: npm run build

       - name: Deploy
         uses: peaceiris/actions-gh-pages@v3
         if: github.ref == 'refs/heads/main'
         with:
           github_token: ${{ secrets.GITHUB_TOKEN }}
           publish_dir: ./out
   ```

3. **å¯ç”¨ GitHub Pages**ï¼š
   - è¿›å…¥ä»“åº“ Settings
   - Pages > Source > GitHub Actions
   - ç­‰å¾…é¦–æ¬¡éƒ¨ç½²å®Œæˆ

---

## ğŸ³ Docker éƒ¨ç½²

### åˆ›å»º Dockerfile

```dockerfile
# å¤šé˜¶æ®µæ„å»º
FROM node:18-alpine AS builder

WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

COPY . .
RUN npm run build

# ç”Ÿäº§é•œåƒ
FROM nginx:alpine

# å¤åˆ¶æ„å»ºäº§ç‰©
COPY --from=builder /app/out /usr/share/nginx/html

# å¤åˆ¶ nginx é…ç½®
COPY nginx.conf /etc/nginx/conf.d/default.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

### åˆ›å»º nginx.conf

```nginx
server {
    listen 80;
    root /usr/share/nginx/html;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    # ç¼“å­˜è®¾ç½®
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

### æ„å»ºå’Œè¿è¡Œ

```bash
# æ„å»ºé•œåƒ
docker build -t halavah-tech-blog .

# è¿è¡Œå®¹å™¨
docker run -d -p 80:80 halavah-tech-blog
```

---

## ğŸ”’ HTTPS é…ç½®

### Let's Encryptï¼ˆNginxï¼‰

```bash
# å®‰è£… Certbot
sudo apt-get install certbot python3-certbot-nginx

# è·å–è¯ä¹¦
sudo certbot --nginx -d yourdomain.com
```

### Cloudflare

1. åœ¨ Cloudflare æ·»åŠ åŸŸå
2. æ›´æ”¹åŸŸåæœåŠ¡å™¨åˆ° Cloudflare
3. å¯ç”¨ SSL/TLS åŠ å¯†æ¨¡å¼ï¼ˆå®Œå…¨æˆ–å®Œå…¨ä¸¥æ ¼ï¼‰

---

## ğŸ“‹ éƒ¨ç½²æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰æ£€æŸ¥

- [ ] æœ¬åœ°æ„å»ºæˆåŠŸï¼ˆ`npm run build`ï¼‰
- [ ] ç¯å¢ƒå˜é‡å·²é…ç½®
- [ ] æ–‡ç« è·¯å¾„æ­£ç¡®
- [ ] å›¾ç‰‡èµ„æºä¼˜åŒ–
- [ ] SEO å…ƒæ•°æ®å®Œæ•´
- [ ] æµ‹è¯•æœç´¢åŠŸèƒ½
- [ ] æµ‹è¯•ä¸»é¢˜åˆ‡æ¢
- [ ] æµ‹è¯•åˆ†ç±»ç­›é€‰
- [ ] æµ‹è¯•åˆ†é¡µåŠŸï¿½ï¿½ï¿½

### éƒ¨ç½²åéªŒè¯

- [ ] ç½‘ç«™å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] æ‰€æœ‰é¡µé¢éƒ½èƒ½æ­£å¸¸åŠ è½½
- [ ] é“¾æ¥éƒ½èƒ½æ­£å¸¸è·³è½¬
- [ ] å›¾ç‰‡æ­£å¸¸æ˜¾ç¤º
- [ ] æœç´¢åŠŸèƒ½æ­£å¸¸
- [ ] ä¸»é¢˜åˆ‡æ¢æ­£å¸¸
- [ ] ç§»åŠ¨ç«¯é€‚é…æ­£å¸¸
- [ ] æ€§èƒ½æŒ‡æ ‡è¾¾æ ‡

---

## ğŸ”§ å¸¸è§é—®é¢˜ä¸æ’æŸ¥

### é—®é¢˜ 1: æ„å»ºå¤±è´¥

**ç—‡çŠ¶**ï¼š`npm run build` å‘½ä»¤æ‰§è¡Œå¤±è´¥

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥ Node.js ç‰ˆæœ¬ï¼ˆéœ€è¦ 18+ï¼‰ï¼š
   ```bash
   node --version
   ```

2. æ¸…é™¤ç¼“å­˜å¹¶é‡æ–°å®‰è£…ä¾èµ–ï¼š
   ```bash
   rm -rf .next node_modules package-lock.json
   npm install
   npm run build
   ```

3. æ£€æŸ¥ TypeScript é”™è¯¯ï¼š
   ```bash
   npx tsc --noEmit
   ```

### é—®é¢˜ 2: è·¯ç”± 404 é”™è¯¯

**ç—‡çŠ¶**ï¼šåˆ·æ–°é¡µé¢æˆ–ç›´æ¥è®¿é—®æ–‡ç« é“¾æ¥æ—¶å‡ºç° 404

**è§£å†³æ–¹æ¡ˆ**ï¼š
- **Vercel/Netlify**: è‡ªåŠ¨å¤„ç†ï¼Œæ— éœ€é…ç½®
- **Nginx**: æ·»åŠ é‡å®šå‘è§„åˆ™ï¼ˆè§ä¸Šæ–‡ Nginx é…ç½®ï¼‰
- **GitHub Pages**: æ·»åŠ  404.html é‡å®šå‘ï¼š
  ```html
  <!DOCTYPE html>
  <html>
  <head>
    <meta http-equiv="refresh" content="0;URL='/'">
  </head>
  </html>
  ```

### é—®é¢˜ 3: å›¾ç‰‡ä¸æ˜¾ç¤º

**ç—‡çŠ¶**ï¼šéƒ¨ç½²åå›¾ç‰‡æ— æ³•åŠ è½½

**æ’æŸ¥æ­¥éª¤**ï¼š
1. ç¡®è®¤å›¾ç‰‡åœ¨ `public/` ç›®å½•ä¸‹
2. æ£€æŸ¥ `next.config.ts` é…ç½®ï¼š
   ```typescript
   images: {
     unoptimized: true
   }
   ```
3. æ£€æŸ¥å›¾ç‰‡è·¯å¾„ï¼ˆç›¸å¯¹è·¯å¾„ vs ç»å¯¹è·¯å¾„ï¼‰

### é—®é¢˜ 4: æ ·å¼ä¸¢å¤±

**ç—‡çŠ¶**ï¼šéƒ¨ç½²åé¡µé¢æ ·å¼ä¸æ­£å¸¸

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥ Tailwind CSS é…ç½®ï¼š
   ```typescript
   // tailwind.config.ts
   content: [
     "./app/**/*.{js,ts,jsx,tsx,mdx}",
   ]
   ```

2. ç¡®è®¤ `globals.css` åŒ…å« Tailwind æŒ‡ä»¤ï¼š
   ```css
   @tailwind base;
   @tailwind components;
   @tailwind utilities;
   ```

3. æ¸…é™¤æ„å»ºç¼“å­˜é‡æ–°æ„å»ºï¼š
   ```bash
   rm -rf .next
   npm run build
   ```

### é—®é¢˜ 5: æœç´¢åŠŸèƒ½ä¸å·¥ä½œ

**ç—‡çŠ¶**ï¼šç‚¹å‡»æœç´¢æŒ‰é’®æ²¡æœ‰ååº”

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰ JavaScript é”™è¯¯
2. ç¡®è®¤ `articles` æ•°æ®æ­£ç¡®ä¼ é€’ç»™ `Navbar` ç»„ä»¶
3. æ£€æŸ¥æ˜¯å¦æœ‰ CSS æ ·å¼å†²çªå¯¼è‡´å¼¹çª—ä¸å¯è§

### é—®é¢˜ 6: ä¸»é¢˜åˆ‡æ¢ä¸ç”Ÿæ•ˆ

**ç—‡çŠ¶**ï¼šç‚¹å‡»ä¸»é¢˜åˆ‡æ¢æŒ‰é’®ï¼Œé¡µé¢æ ·å¼æ²¡æœ‰å˜åŒ–

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥æµè§ˆå™¨ localStorage æ˜¯å¦å¯ç”¨
2. ç¡®è®¤ `globals.css` ä¸­å®šä¹‰äº†ä¸¤å¥—ä¸»é¢˜ CSS å˜é‡
3. æ£€æŸ¥ `data-theme` å±æ€§æ˜¯å¦æ­£ç¡®è®¾ç½®åˆ° `<html>` å…ƒç´ 

### é—®é¢˜ 7: åˆ†é¡µä¸æ˜¾ç¤º

**ç—‡çŠ¶**ï¼šæ–‡ç« å¾ˆå¤šä½†æ²¡æœ‰åˆ†é¡µå™¨

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥ `totalPages` æ˜¯å¦å¤§äº 1
2. ç¡®è®¤ `Pagination` ç»„ä»¶æ­£ç¡®å¼•å…¥
3. æ£€æŸ¥æ¡ä»¶æ¸²æŸ“é€»è¾‘ï¼š
   ```tsx
   {totalPages > 1 && currentArticles.length > 0 && (
     <Pagination ... />
   )}
   ```

### é—®é¢˜ 8: éƒ¨ç½²åæ€§èƒ½å·®

**ç—‡çŠ¶**ï¼šLighthouse è¯„åˆ†ä½ï¼ŒåŠ è½½æ…¢

**ä¼˜åŒ–æªæ–½**ï¼š
1. **å¯ç”¨ Gzip å‹ç¼©**ï¼ˆæœåŠ¡å™¨é…ç½®ï¼‰
2. **ä¼˜åŒ–å›¾ç‰‡**ï¼š
   - ä½¿ç”¨ WebP æ ¼å¼
   - å‹ç¼©å›¾ç‰‡æ–‡ä»¶å¤§å°
   - æ·»åŠ æ‡’åŠ è½½
3. **ä½¿ç”¨ CDN**ï¼š
   - é…ç½® CloudFront/Cloudflare
   - ç¼“å­˜é™æ€èµ„æº
4. **å‡å°‘ JavaScript å¤§å°**ï¼š
   - ç§»é™¤æœªä½¿ç”¨çš„ä¾èµ–
   - ä»£ç åˆ†å‰²

---

## ğŸ› ï¸ è¿ç»´å·¥å…·å’Œè„šæœ¬

### è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬

åˆ›å»º `scripts/deploy.sh`ï¼š

```bash
#!/bin/bash

echo "ğŸš€ å¼€å§‹éƒ¨ç½²..."

# 1. æ¸…ç†æ—§æ„å»º
echo "ğŸ“¦ æ¸…ç†æ—§æ„å»º..."
rm -rf .next out

# 2. å®‰è£…ä¾èµ–
echo "ğŸ“¥ å®‰è£…ä¾èµ–..."
npm install

# 3. æ„å»ºé¡¹ç›®
echo "ğŸ”¨ æ„å»ºé¡¹ç›®..."
npm run build

# 4. ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆç¤ºä¾‹ï¼šä½¿ç”¨ rsyncï¼‰
echo "ğŸ“¤ ä¸Šä¼ åˆ°æœåŠ¡å™¨..."
rsync -avz --delete out/ user@server:/var/www/html/

echo "âœ… éƒ¨ç½²å®Œæˆï¼"
```

ä½¿ç”¨æ–¹æ³•ï¼š

```bash
chmod +x scripts/deploy.sh
./scripts/deploy.sh
```

### å¤‡ä»½è„šæœ¬

åˆ›å»º `scripts/backup.sh`ï¼š

```bash
#!/bin/bash

# å¤‡ä»½ç›®å½•
BACKUP_DIR="backups/$(date +%Y%m%d_%H%M%S)"

mkdir -p $BACKUP_DIR

# å¤‡ä»½æ–‡ç« å’Œé…ç½®
cp -r public/ $BACKUP_DIR/
cp -r data/ $BACKUP_DIR/
cp -r docs/ $BACKUP_DIR/

echo "âœ… å¤‡ä»½å®Œæˆï¼š$BACKUP_DIR"
```

### ç”Ÿæˆ Sitemap

åˆ›å»º `scripts/generate-sitemap.js`ï¼š

```javascript
const fs = require('fs');
const articles = require('../data/articles.json');

const DOMAIN = 'https://yourdomain.com';

const sitemap = `<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
  <url>
    <loc>${DOMAIN}</loc>
    <changefreq>daily</changefreq>
    <priority>1.0</priority>
  </url>
  <url>
    <loc>${DOMAIN}/articles</loc>
    <changefreq>daily</changefreq>
    <priority>0.9</priority>
  </url>
  <url>
    <loc>${DOMAIN}/categories</loc>
    <changefreq>weekly</changefreq>
    <priority>0.8</priority>
  </url>
  <url>
    <loc>${DOMAIN}/about</loc>
    <changefreq>monthly</changefreq>
    <priority>0.7</priority>
  </url>
${articles.articles.map(article => `  <url>
    <loc>${DOMAIN}/article/${article.htmlFile.replace('.html', '')}</loc>
    <changefreq>monthly</changefreq>
    <priority>0.8</priority>
  </url>`).join('\n')}
</urlset>`;

fs.writeFileSync('public/sitemap.xml', sitemap);
console.log('âœ… Sitemap ç”ŸæˆæˆåŠŸï¼špublic/sitemap.xml');
```

ä½¿ç”¨æ–¹æ³•ï¼š

```bash
node scripts/generate-sitemap.js
```

---

## ğŸ“Š æ€§èƒ½ç›‘æ§

### Google Analytics

åœ¨ `app/layout.tsx` ä¸­æ·»åŠ ï¼š

```tsx
import Script from 'next/script';

export default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="zh-CN">
      <body>
        {children}

        {/* Google Analytics */}
        <Script
          src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"
          strategy="afterInteractive"
        />
        <Script id="google-analytics" strategy="afterInteractive">
          {`
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'GA_MEASUREMENT_ID');
          `}
        </Script>
      </body>
    </html>
  );
}
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. å®šæœŸç»´æŠ¤

- **æ¯å‘¨**ï¼šæ£€æŸ¥ç½‘ç«™å¯è®¿é—®æ€§å’ŒåŠŸèƒ½æ­£å¸¸æ€§
- **æ¯æœˆ**ï¼šæ›´æ–°ä¾èµ–åŒ…ï¼Œä¿®å¤å®‰å…¨æ¼æ´
- **æ¯å­£åº¦**ï¼šæ€§èƒ½ä¼˜åŒ–ï¼ŒLighthouse è¯„åˆ†æ£€æŸ¥

### 2. å¤‡ä»½ç­–ç•¥

- ä½¿ç”¨ Git ç®¡ç†æ‰€æœ‰ä»£ç å’Œå†…å®¹
- å®šæœŸå¤‡ä»½ `public/` å’Œ `data/` ç›®å½•
- ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬å®šæœŸå¤‡ä»½

### 3. ç›‘æ§å’Œæ—¥å¿—

- é…ç½®ç½‘ç«™ç›‘æ§ï¼ˆUptimeRobotã€Pingdomï¼‰
- å¯ç”¨é”™è¯¯è¿½è¸ªï¼ˆSentryï¼‰
- æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—

### 4. å®‰å…¨æªæ–½

- åŠæ—¶æ›´æ–°ä¾èµ–ä¿®å¤å®‰å…¨æ¼æ´
- ä½¿ç”¨ HTTPS
- é…ç½® CSPï¼ˆContent Security Policyï¼‰
- å®šæœŸæ£€æŸ¥ npm audit

### 5. æ€§èƒ½ä¼˜åŒ–

- å¯ç”¨ CDN åŠ é€Ÿ
- å‹ç¼©é™æ€èµ„æº
- ä¼˜åŒ–å›¾ç‰‡
- ä½¿ç”¨ç¼“å­˜ç­–ç•¥

---

## ğŸ†˜ è·å–å¸®åŠ©

### é‡åˆ°é—®é¢˜ï¼Ÿ

1. **æ£€æŸ¥æ–‡æ¡£**ï¼š
   - [é¡¹ç›®æ€»è§ˆä¸å¿«é€Ÿå¼€å§‹](./01.é¡¹ç›®æ€»è§ˆä¸å¿«é€Ÿå¼€å§‹.md)
   - [å¼€å‘æŒ‡å—](./02.å¼€å‘æŒ‡å—.md)
   - [å†…å®¹ç®¡ç†](./03.å†…å®¹ç®¡ç†.md)

2. **æŸ¥çœ‹é”™è¯¯æ—¥å¿—**ï¼š
   - æ„å»ºæ—¥å¿—
   - æµè§ˆå™¨æ§åˆ¶å°
   - æœåŠ¡å™¨æ—¥å¿—

3. **æ¸…é™¤ç¼“å­˜é‡è¯•**ï¼š
   ```bash
   rm -rf .next node_modules/.cache
   npm install
   npm run build
   ```

4. **æäº¤ Issue**ï¼š
   - åœ¨ GitHub ä»“åº“æäº¤ Issue
   - åŒ…å«è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œé‡ç°æ­¥éª¤

---

æ­å–œï¼æ‚¨çš„åšå®¢ç°åœ¨å·²ç»éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚äº«å—æ‚¨çš„å†™ä½œä¹‹æ—…ï¼ğŸš€
