# CCStatusLine - Claude Code 美观状态行工具

> 为Claude Code CLI提供美观且高度可定制的状态行，支持Powerline主题、多种配置选项、自定义颜色和小组件

## 目录导航

1. [什么是 CCStatusLine？](#1-什么是-ccstatusline)
2. [核心功能特性](#2-核心功能特性)
3. [系统架构](#3-系统架构)
4. [安装指南](#4-安装指南)
5. [配置说明](#5-配置说明)
6. [使用方法](#6-使用方法)
7. [故障排除](#7-故障排除)

## 1. 什么是 CCStatusLine？

CCStatusLine 是专为 Claude Code CLI 设计的美观状态行工具，旨在为用户提供丰富的信息展示和高度可定制的界面体验。通过支持 Powerline 风格的主题和多种小组件，CCStatusLine 让终端界面更加美观和实用。

### 核心价值

- **美观界面**：Powerline 风格的美观状态行
- **高度定制**：支持自定义颜色、布局和小组件
- **信息丰富**：显示模型信息、Git分支、Token使用情况等
- **易于使用**：简单的配置和直观的界面
- **轻量高效**：不影响命令行工具的性能

### 设计理念

CCStatusLine 遵循简洁而强大的设计原则：
- **视觉美观**：现代化的终端界面设计
- **功能实用**：显示开发者关心的关键信息
- **配置灵活**：满足不同用户的个性化需求
- **性能优先**：最小化资源占用

## 2. 核心功能特性

### 🎨 Powerline 主题支持
- **内置主题**：多种预置的 Powerline 风格主题
- **自定义主题**：支持创建和分享自定义主题
- **颜色配置**：每个小组件都可以单独配置颜色
- **图标支持**：丰富的图标和符号选择

### 🔧 高度可定制性
- **小组件管理**：添加、删除、重新排序状态行小组件
- **布局配置**：灵活的布局和分隔符配置
- **行为设置**：可配置的伸缩分隔符行为
- **条件显示**：根据条件显示或隐藏特定信息

### 📊 信息显示
- **模型信息**：当前使用的 AI 模型
- **Git 状态**：分支名称、提交状态等
- **Token 使用**：实时显示 Token 消耗情况
- **会话信息**：当前会话的相关信息
- **系统状态**：CPU、内存等系统信息

### ⚡ 性能优化
- **轻量设计**：最小化性能影响
- **缓存机制**：智能缓存提高响应速度
- **异步更新**：非阻塞的状态更新
- **资源管理**：高效的资源使用

### 🛠️ 开发者友好
- **配置简单**：直观的配置文件格式
- **热重载**：配置更改即时生效
- **调试支持**：详细的调试信息和日志
- **插件接口**：支持扩展功能

## 3. 系统架构

### 技术架构
```
Claude Code CLI
    ↓
CCStatusLine Engine
    ├── Widget Manager
    ├── Theme Engine
    ├── Config Parser
    └── Renderer
    ↓
Terminal Output
```

### 核心组件

#### Widget Manager（小组件管理器）
- **小组件注册**：管理和注册各种小组件
- **生命周期管理**：管理小组件的创建、更新和销毁
- **事件处理**：处理小组件的事件和交互
- **数据绑定**：绑定数据源到小组件

#### Theme Engine（主题引擎）
- **主题解析**：解析和应用主题配置
- **颜色管理**：管理和渲染颜色
- **图标处理**：处理图标和符号
- **样式计算**：计算最终的显示样式

#### Config Parser（配置解析器）
- **配置文件解析**：解析 YAML/JSON 配置文件
- **配置验证**：验证配置的正确性
- **热重载**：监控配置文件变化
- **默认值处理**：处理配置的默认值

#### Renderer（渲染器）
- **终端渲染**：渲染到终端输出
- **格式化**：格式化显示内容
- **布局计算**：计算布局和位置
- **输出优化**：优化输出性能

## 4. 安装指南

### 4.1 系统要求

#### 支持平台
- **Linux**：Ubuntu 18.04+, CentOS 7+, Debian 9+
- **macOS**：macOS 10.15 或更高版本
- **Windows**：Windows 10 1903 或更高版本 (通过 WSL)

#### 依赖要求
- **Node.js**：16.0.0 或更高版本
- **Bun**：推荐的 JavaScript 运行时
- **Claude Code**：最新版本

### 4.2 安装方式

#### 方式1：使用 Bun 安装（推荐）
```bash
# 克隆仓库
git clone https://github.com/sirmalloc/ccstatusline.git
cd ccstatusline

# 安装依赖
bun install

# 启动 TUI 模式
bun run src/ccstatusline.ts
```

#### 方式2：使用 npm 安装
```bash
# 克隆仓库
git clone https://github.com/sirmalloc/ccstatusline.git
cd ccstatusline

# 安装依赖
npm install

# 构建项目
npm run build

# 启动应用
npm start
```

#### 方式3：全局安装
```bash
# 使用 npm 全局安装
npm install -g ccstatusline

# 使用 bun 全局安装
bun install -g ccstatusline

# 验证安装
ccstatusline --version
```

### 4.3 初始配置

#### 创建配置文件
```bash
# 初始化配置
ccstatusline init

# 这将在 ~/.config/ccstatusline/ 目录下创建默认配置文件
```

#### 基础配置文件
```yaml
# ~/.config/ccstatusline/config.yaml
theme: "default"
layout: "powerline"

widgets:
  - type: "model"
    position: "left"
    color: "blue"

  - type: "git"
    position: "left"
    color: "green"

  - type: "tokens"
    position: "right"
    color: "yellow"

  - type: "time"
    position: "right"
    color: "cyan"

separators:
  type: "arrow"
  color: "gray"
```

## 5. 配置说明

### 5.1 主题配置

#### 内置主题
```yaml
# 主题选择
theme: "default"  # default, dark, light, minimal

# 或自定义主题
custom_theme:
  background: "#1e1e1e"
  foreground: "#ffffff"
  accent: "#61afef"
  success: "#98c379"
  warning: "#e5c07b"
  error: "#e06c75"
```

#### Powerline 配置
```yaml
powerline:
  enabled: true
  symbols:
    left_separator: ""
    right_separator: ""
    branch_symbol: ""
    lock_symbol: ""
    separator: ""

  colors:
    bg1: "#3a3a3a"
    bg2: "#4a4a4a"
    fg: "#ffffff"
    separator: "#888888"
```

### 5.2 小组件配置

#### 模型小组件
```yaml
widgets:
  - type: "model"
    position: "left"
    format: "{model} ({provider})"
    color: "blue"
    show_provider: true
    max_length: 20
```

#### Git 小组件
```yaml
widgets:
  - type: "git"
    position: "left"
    color: "green"
    show_branch: true
    show_status: true
    show_ahead_behind: true
    status_symbols:
      added: "+"
      modified: "~"
      deleted: "-"
      renamed: ">"
```

#### Token 使用小组件
```yaml
widgets:
  - type: "tokens"
    position: "right"
    color: "yellow"
    format: "Tokens: {used}/{limit}"
    show_percentage: true
    warning_threshold: 80
    critical_threshold: 95
```

#### 时间小组件
```yaml
widgets:
  - type: "time"
    position: "right"
    color: "cyan"
    format: "%H:%M:%S"
    show_date: false
    timezone: "local"
```

### 5.3 布局配置

#### 分段布局
```yaml
layout:
  type: "segments"
  left:
    - widget: "model"
    - widget: "git"
    - widget: "cwd"

  center:
    - widget: "session"

  right:
    - widget: "tokens"
    - widget: "time"
```

#### 单行布局
```yaml
layout:
  type: "single"
  widgets:
    - widget: "model"
    - widget: "git"
    - widget: "tokens"
    - widget: "time"
```

### 5.4 高级配置

#### 性能配置
```yaml
performance:
  update_interval: 1000  # 毫秒
  cache_enabled: true
  cache_ttl: 300  # 秒
  max_concurrent_updates: 5
```

#### 调试配置
```yaml
debug:
  enabled: false
  log_level: "info"
  log_file: "~/.ccstatusline/logs/debug.log"
  show_performance: false
```

## 6. 使用方法

### 6.1 基础使用

#### 启动状态行
```bash
# 使用默认配置启动
ccstatusline

# 指定配置文件启动
ccstatusline --config /path/to/config.yaml

# 启动特定主题
ccstatusline --theme dark

# 启用调试模式
ccstatusline --debug
```

#### TUI 模式
```bash
# 启动 TUI 配置界面
ccstatusline --tui

# 或者
ccstatusline -i
```

### 6.2 配置管理

#### 查看当前配置
```bash
# 显示当前配置
ccstatusline config show

# 验证配置文件
ccstatusline config validate

# 重置为默认配置
ccstatusline config reset
```

#### 配置热重载
```bash
# 启用配置热重载
ccstatusline --watch

# 手动重载配置
ccstatusline reload
```

### 6.3 主题管理

#### 列出可用主题
```bash
# 列出内置主题
ccstatusline theme list

# 预览主题
ccstatusline theme preview dark

# 应用主题
ccstatusline theme apply dark
```

#### 创建自定义主题
```bash
# 创建主题模板
ccstatusline theme create my-theme

# 编辑主题文件
vim ~/.config/ccstatusline/themes/my-theme.yaml

# 测试主题
ccstatusline --theme my-theme
```

### 6.4 集成使用

#### 与 Shell 集成
```bash
# 添加到 .bashrc 或 .zshrc
eval "$(ccstatusline init bash)"
# 或
eval "$(ccstatusline init zsh)"
```

#### 与 Claude Code 集成
```bash
# 启动 Claude Code 时自动加载状态行
alias claude='ccstatusline && claude'
```

#### 自定义脚本集成
```bash
#!/bin/bash
# 自定义脚本中集成 CCStatusLine

# 启动状态行（后台运行）
ccstatusline --daemon &

# 你的主要脚本逻辑
echo "运行主程序..."

# 停止状态行
pkill ccstatusline
```

## 7. 故障排除

### 常见问题

#### 1. 状态行不显示
```bash
# 检查安装
ccstatusline --version

# 验证配置
ccstatusline config validate

# 检查权限
ls -la ~/.config/ccstatusline/

# 启用调试模式
ccstatusline --debug
```

#### 2. 主题加载失败
```bash
# 检查主题文件
ccstatusline theme validate theme-name

# 重新加载主题
ccstatusline theme reload theme-name

# 重置主题
ccstatusline theme reset
```

#### 3. 性能问题
```bash
# 检查性能统计
ccstatusline --stats

# 清理缓存
ccstatusline cache clear

# 优化配置
ccstatusline optimize
```

#### 4. 颜色显示异常
```bash
# 检查终端颜色支持
ccstatusline test colors

# 重置颜色配置
ccstatusline config reset colors

# 使用安全模式
ccstatusline --safe-mode
```

### 调试工具

#### 系统诊断
```bash
# 运行完整诊断
ccstatusline doctor

# 检查终端兼容性
ccstatusline test terminal

# 检查字体支持
ccstatusline test fonts
```

#### 日志分析
```bash
# 查看详细日志
ccstatusline --log-level debug

# 分析日志文件
ccstatusline logs analyze

# 导出诊断报告
ccstatusline doctor --export report.json
```

## 更新日志

### v2.2.0 (最新)
- 🎉 新增 TUI 配置界面
- ✨ 支持更多自定义小组件
- 🔧 改进性能和稳定性
- 🐛 修复颜色显示问题

### v2.1.0
- 🚀 新增主题系统
- ✨ 支持配置热重载
- 🎨 改进 Powerline 渲染
- 📊 新增性能监控

### v2.0.0
- 🔄 重构核心架构
- ✨ 支持插件系统
- 🎨 全新主题引擎
- 🔧 简化配置格式

### v1.0.0
- 🎉 首个公开发布
- ⚡ 基础状态行功能
- 🔧 Powerline 支持
- 📚 完整文档

## 贡献指南

欢迎为 CCStatusLine 项目贡献代码！

### 开发环境
```bash
# 克隆仓库
git clone https://github.com/sirmalloc/ccstatusline.git
cd ccstatusline

# 安装依赖
bun install

# 启动开发模式
bun run dev

# 运行测试
bun test
```

### 代码贡献
1. Fork 项目
2. 创建功能分支
3. 编写测试
4. 提交 Pull Request

### 主题贡献
- 创建新的主题文件
- 遵循主题设计规范
- 提供预览图片
- 提交主题 PR

## 许可证

本项目采用 MIT 许可证。详情请参阅 [LICENSE](https://github.com/sirmalloc/ccstatusline/blob/main/LICENSE) 文件。

## 相关资源

- [GitHub 仓库](https://github.com/sirmalloc/ccstatusline)
- [教程文章](https://juejin.cn/post/7564047018794106899)
- [用户社区](https://github.com/sirmalloc/ccstatusline/discussions)
- [主题库](https://github.com/sirmalloc/ccstatusline-themes)
- [API 文档](https://ccstatusline.docs.com/)

## 致谢

感谢以下项目和社区的支持：
- Powerline 社区的设计灵感
- Claude Code 用户的宝贵反馈
- 开源社区的贡献者们

---

> 💡 **提示**: CCStatusLine 是一个活跃开发的开源项目，如果你觉得有用，请考虑给项目一个 Star（目前已获得 2.22k+ stars）！让 Claude Code 的终端体验更加美观和实用！