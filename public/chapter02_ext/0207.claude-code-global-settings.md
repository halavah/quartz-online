# Claude Code å…¨å±€é…ç½®ä¸è®¾ç½®

> å…¨é¢æŒæ¡Claude Codeé…ç½®ç³»ç»Ÿï¼ŒåŒ…å«settings.jsoné…ç½®ã€ç¯å¢ƒå˜é‡ã€ä¼ä¸šéƒ¨ç½²ç­–ç•¥å’Œæœ€ä½³å®è·µ

## ç›®å½•å¯¼èˆª

1. [settings.jsonå®Œå…¨é…ç½®](#1-settingsjsonå®Œå…¨é…ç½®)
2. [ç¯å¢ƒå˜é‡å¤§å…¨](#2-ç¯å¢ƒå˜é‡å¤§å…¨)
3. [ä¼ä¸šçº§éƒ¨ç½²ç­–ç•¥](#3-ä¼ä¸šçº§éƒ¨ç½²ç­–ç•¥)
4. [é…ç½®ä¼˜å…ˆçº§è¯¦è§£](#4-é…ç½®ä¼˜å…ˆçº§è¯¦è§£)
5. [æœ€ä½³å®è·µå»ºè®®](#5-æœ€ä½³å®è·µå»ºè®®)

## 1. settings.jsonå®Œå…¨é…ç½®

### 1.1 é…ç½®æ–‡ä»¶ä½ç½®

| é…ç½®ç±»å‹ | æ–‡ä»¶ä½ç½® | æè¿° |
|----------|----------|------|
| ä¼ä¸šç­–ç•¥ | macOS: `/Library/Application Support/ClaudeCode/policies.json`<br>Linux: `/etc/claude-code/policies.json`<br>Windows: `%PROGRAMDATA%\ClaudeCode\policies.json` | ä¼ä¸šçº§ç­–ç•¥é…ç½®ï¼Œæœ€é«˜ä¼˜å…ˆçº§ |
| ç”¨æˆ·å…¨å±€ | `~/.claude/settings.json` | ç”¨æˆ·ä¸ªäººé…ç½®ï¼Œæ‰€æœ‰é¡¹ç›®ç”Ÿæ•ˆ |
| é¡¹ç›®å…±äº« | `.claude/settings.json` | é¡¹ç›®å…±äº«é…ç½®ï¼Œå¯æäº¤åˆ°Git |
| é¡¹ç›®æœ¬åœ° | `.claude/settings.local.json` | é¡¹ç›®æœ¬åœ°é…ç½®ï¼Œè¢«Gitå¿½ç•¥ |

### 1.2 å®Œæ•´é…ç½®ç¤ºä¾‹

#### ç”¨æˆ·å…¨å±€é…ç½®ç¤ºä¾‹

```json
{
  // APIå’Œè®¤è¯é…ç½®
  "apiKeyHelper": "/usr/local/bin/company-key-helper.sh",

  // ç¯å¢ƒå˜é‡
  "env": {
    "ANTHROPIC_BASE_URL": "https://open.bigmodel.cn/api/anthropic",
    "ANTHROPIC_DEFAULT_SONNET_MODEL": "glm-4.6",
    "ANTHROPIC_DEFAULT_HAIKU_MODEL": "glm-4.5-air",
    "NODE_ENV": "development",
    "EDITOR": "code"
  },

  // æƒé™é…ç½®
  "permissions": {
    "allow": [
      "Bash(npm run *)",
      "Bash(git status)",
      "Bash(git diff)",
      "Read(*)",
      "Write(*.md)",
      "Write(*.js)",
      "Write(*.ts)",
      "Write(*.tsx)"
    ],
    "deny": [
      "Bash(rm -rf *)",
      "Bash(sudo *)",
      "Bash(curl *)",
      "Write(~/.ssh/*)",
      "Write(/etc/*)"
    ]
  },

  // å…¶ä»–é…ç½®
  "cleanupPeriodDays": 30,
  "includeCoAuthoredBy": true,

  // å¯ç”¨çš„æ’ä»¶
  "enabledPlugins": {
    "frontend-design@claude-code-plugins": true,
    "github@claude-code-plugins": true
  }
}
```

#### é¡¹ç›®çº§é…ç½®ç¤ºä¾‹

```json
{
  // é¡¹ç›®ç‰¹å®šç¯å¢ƒå˜é‡
  "env": {
    "PROJECT_NAME": "my-ecommerce-app",
    "API_BASE_URL": "https://api.myapp.com",
    "DATABASE_URL": "postgresql://localhost:5432/myapp_dev"
  },

  // é¡¹ç›®æƒé™é…ç½®
  "permissions": {
    "allow": [
      "Bash(npm run dev)",
      "Bash(npm run test)",
      "Bash(npm run build)",
      "Bash(docker compose up)",
      "Read(src/**/*)",
      "Write(src/**/*)"
    ],
    "deny": [
      "Bash(npm run deploy)",
      "Write(production.env)"
    ]
  },

  // é¡¹ç›®ç‰¹å®šé…ç½®
  "defaultModel": "claude-sonnet-4",
  "maxOutputTokens": 8192,

  // å›¢é˜Ÿé…ç½®
  "team": {
    "name": "frontend-team",
    "slackChannel": "#frontend-dev",
    "codeReviewAssign": "@senior-dev"
  }
}
```

### 1.3 é«˜çº§é…ç½®é€‰é¡¹

#### æ€§èƒ½ä¼˜åŒ–é…ç½®

```json
{
  // æ€§èƒ½ç›¸å…³é…ç½®
  "env": {
    "BASH_DEFAULT_TIMEOUT_MS": "300000",
    "BASH_MAX_TIMEOUT_MS": "600000",
    "BASH_MAX_OUTPUT_LENGTH": "100000",
    "CLAUDE_CODE_MAX_OUTPUT_TOKENS": "8192",
    "MCP_TIMEOUT": "60000",
    "MCP_TOOL_TIMEOUT": "30000"
  },

  // æ¨¡å‹é…ç½®
  "modelSettings": {
    "default": "claude-sonnet-4",
    "reasoning": {
      "maxThinkingTokens": 8192,
      "temperature": 0.1
    },
    "creative": {
      "temperature": 0.8,
      "topP": 0.9
    }
  }
}
```

#### ç½‘ç»œå’Œä»£ç†é…ç½®

```json
{
  // ä»£ç†é…ç½®
  "env": {
    "HTTP_PROXY": "http://proxy.company.com:8080",
    "HTTPS_PROXY": "http://proxy.company.com:8080",
    "NO_PROXY": "localhost,127.0.0.1,.company.com",
    "ANTHROPIC_BASE_URL": "https://api-gateway.company.com/anthropic"
  },

  // ç½‘ç»œè¶…æ—¶é…ç½®
  "network": {
    "timeout": 30000,
    "retries": 3,
    "retryDelay": 1000
  }
}
```

## 2. ç¯å¢ƒå˜é‡å¤§å…¨

### 2.1 APIå’Œè®¤è¯ç›¸å…³

| å˜é‡å | æè¿° | ç¤ºä¾‹å€¼ |
|--------|------|--------|
| `ANTHROPIC_API_KEY` | APIå¯†é’¥ï¼ˆX-Api-Keyå¤´ï¼‰ | `sk-ant-...` |
| `ANTHROPIC_AUTH_TOKEN` | è®¤è¯ä»¤ç‰Œï¼ˆAuthorizationå¤´ï¼‰ | `sk-...` |
| `ANTHROPIC_BASE_URL` | è‡ªå®šä¹‰APIç«¯ç‚¹ | `https://api.anthropic.com` |
| `ANTHROPIC_CUSTOM_HEADERS` | è‡ªå®šä¹‰HTTPå¤´ | `X-Custom-Header: value` |

#### é…ç½®ç¤ºä¾‹

```bash
# åŸºç¡€è®¤è¯é…ç½®
export ANTHROPIC_AUTH_TOKEN="sk-ant-api03-..."
export ANTHROPIC_BASE_URL="https://open.bigmodel.cn/api/anthropic"

# è‡ªå®šä¹‰è¯·æ±‚å¤´
export ANTHROPIC_CUSTOM_HEADERS="X-Team: frontend,X-Project: ecommerce"

# APIå¯†é’¥åŠ©æ‰‹
export CLAUDE_CODE_API_KEY_HELPER_TTL_MS="3600000"
```

### 2.2 æ¨¡å‹é…ç½®

| å˜é‡å | æè¿° | ç¤ºä¾‹å€¼ |
|--------|------|--------|
| `ANTHROPIC_MODEL` | é»˜è®¤æ¨¡å‹åç§° | `claude-sonnet-4` |
| `ANTHROPIC_DEFAULT_SONNET_MODEL` | Sonnetæ¨¡å‹æ˜ å°„ | `glm-4.6` |
| `ANTHROPIC_DEFAULT_HAIKU_MODEL` | Haikuæ¨¡å‹æ˜ å°„ | `glm-4.5-air` |
| `ANTHROPIC_DEFAULT_OPUS_MODEL` | Opusæ¨¡å‹æ˜ å°„ | `glm-4.6` |
| `ANTHROPIC_SMALL_FAST_MODEL` | å¿«é€Ÿå°æ¨¡å‹ | `glm-4.5-air` |
| `MAX_THINKING_TOKENS` | æ€è€ƒTokené¢„ç®— | `8192` |

#### é…ç½®ç¤ºä¾‹

```bash
# GLMæ¨¡å‹æ˜ å°„
export ANTHROPIC_DEFAULT_SONNET_MODEL="glm-4.6"
export ANTHROPIC_DEFAULT_HAIKU_MODEL="glm-4.5-air"
export ANTHROPIC_DEFAULT_OPUS_MODEL="glm-4.6"

# æ€è€ƒé…ç½®
export MAX_THINKING_TOKENS="16384"
export ANTHROPIC_MODEL="GLM-4.6"
```

### 2.3 Bashå’Œæ‰§è¡Œç¯å¢ƒ

| å˜é‡å | æè¿° | é»˜è®¤å€¼ |
|--------|------|--------|
| `BASH_DEFAULT_TIMEOUT_MS` | Bashå‘½ä»¤é»˜è®¤è¶…æ—¶ | `120000` |
| `BASH_MAX_TIMEOUT_MS` | Bashå‘½ä»¤æœ€å¤§è¶…æ—¶ | `600000` |
| `BASH_MAX_OUTPUT_LENGTH` | Bashè¾“å‡ºæœ€å¤§é•¿åº¦ | `30000` |
| `CLAUDE_BASH_MAINTAIN_PROJECT_WORKING_DIR` | ä¿æŒé¡¹ç›®å·¥ä½œç›®å½• | `false` |

#### é…ç½®ç¤ºä¾‹

```bash
# Bashè¶…æ—¶é…ç½®
export BASH_DEFAULT_TIMEOUT_MS="300000"
export BASH_MAX_TIMEOUT_MS="1800000"
export BASH_MAX_OUTPUT_LENGTH="100000"

# å·¥ä½œç›®å½•é…ç½®
export CLAUDE_BASH_MAINTAIN_PROJECT_WORKING_DIR="true"
```

### 2.4 åŠŸèƒ½å¼€å…³

| å˜é‡å | æè¿° | å€¼ |
|--------|------|----|
| `CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC` | ç¦ç”¨éå¿…è¦æµé‡ | `1` |
| `DISABLE_AUTOUPDATER` | ç¦ç”¨è‡ªåŠ¨æ›´æ–° | `1` |
| `DISABLE_BUG_COMMAND` | ç¦ç”¨/bugå‘½ä»¤ | `1` |
| `DISABLE_COST_WARNINGS` | ç¦ç”¨æˆæœ¬è­¦å‘Š | `1` |
| `DISABLE_ERROR_REPORTING` | ç¦ç”¨é”™è¯¯æŠ¥å‘Š | `1` |
| `DISABLE_TELEMETRY` | ç¦ç”¨é¥æµ‹ | `1` |
| `DISABLE_NON_ESSENTIAL_MODEL_CALLS` | ç¦ç”¨éå¿…è¦æ¨¡å‹è°ƒç”¨ | `1` |

#### é…ç½®ç¤ºä¾‹

```bash
# ç¦ç”¨éå¿…è¦åŠŸèƒ½
export CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC="1"
export DISABLE_AUTOUPDATER="1"
export DISABLE_TELEMETRY="1"
export DISABLE_ERROR_REPORTING="1"

# ä¿ç•™å¿…è¦åŠŸèƒ½
export DISABLE_COST_WARNINGS="0"  # ä¿ç•™æˆæœ¬æé†’
```

### 2.5 ç½‘ç»œå’Œä»£ç†

| å˜é‡å | æè¿° | ç¤ºä¾‹å€¼ |
|--------|------|--------|
| `HTTP_PROXY` | HTTPä»£ç†æœåŠ¡å™¨ | `http://proxy:8080` |
| `HTTPS_PROXY` | HTTPSä»£ç†æœåŠ¡å™¨ | `https://proxy:8080` |
| `NO_PROXY` | ä»£ç†ç»•è¿‡åˆ—è¡¨ | `localhost,127.0.0.1` |
| `CLAUDE_CODE_SKIP_BEDROCK_AUTH` | è·³è¿‡Bedrockè®¤è¯ | `1` |
| `CLAUDE_CODE_SKIP_VERTEX_AUTH` | è·³è¿‡Vertexè®¤è¯ | `1` |

#### é…ç½®ç¤ºä¾‹

```bash
# ä»£ç†é…ç½®
export HTTP_PROXY="http://proxy.company.com:8080"
export HTTPS_PROXY="http://proxy.company.com:8080"
export NO_PROXY="localhost,127.0.0.1,.company.com,.local"

# ç‰¹æ®Šå¹³å°é…ç½®
export CLAUDE_CODE_SKIP_BEDROCK_AUTH="1"
export CLAUDE_CODE_USE_VERTEX="1"
```

## 3. ä¼ä¸šçº§éƒ¨ç½²ç­–ç•¥

### 3.1 ä¼ä¸šç­–ç•¥é…ç½®

#### macOSä¼ä¸šé…ç½®

```bash
# åˆ›å»ºä¼ä¸šç­–ç•¥ç›®å½•
sudo mkdir -p "/Library/Application Support/ClaudeCode"

# åˆ›å»ºç­–ç•¥æ–‡ä»¶
sudo tee "/Library/Application Support/ClaudeCode/policies.json" << 'EOF'
{
  "permissions": {
    "allow": [
      "Read(/Users/*/projects/*)",
      "Write(/Users/*/projects/*/src/**/*)",
      "Bash(npm run test)",
      "Bash(npm run build)",
      "Bash(git status)",
      "Bash(git diff)"
    ],
    "deny": [
      "Write(/etc/*)",
      "Write(~/.ssh/*)",
      "Bash(sudo *)",
      "Bash(curl *)",
      "Bash(wget *)",
      "Bash(rm -rf /)"
    ]
  },

  "env": {
    "ANTHROPIC_BASE_URL": "https://api-gateway.company.com/anthropic",
    "ANTHROPIC_API_KEY_HELPER": "/usr/local/bin/company-key-helper.sh",
    "CLAUDE_CODE_ENABLE_TELEMETRY": "0",
    "DISABLE_TELEMETRY": "1",
    "DISABLE_ERROR_REPORTING": "1",
    "COMPANY_POLICY": "strict"
  },

  "cleanupPeriodDays": 7,
  "includeCoAuthoredBy": true,

  "network": {
    "allowedHosts": [
      "api-gateway.company.com",
      "github.com",
      "npm.pkg.github.com"
    ],
    "blockedHosts": [
      "pastebin.com",
      "transfer.sh"
    ]
  },

  "audit": {
    "enabled": true,
    "logPath": "/var/log/claude-code/audit.log",
    "logLevel": "info"
  }
}
EOF

# è®¾ç½®æƒé™
sudo chown -R root:wheel "/Library/Application Support/ClaudeCode"
sudo chmod 755 "/Library/Application Support/ClaudeCode"
sudo chmod 644 "/Library/Application Support/ClaudeCode/policies.json"
```

#### Linuxä¼ä¸šé…ç½®

```bash
# åˆ›å»ºä¼ä¸šé…ç½®ç›®å½•
sudo mkdir -p /etc/claude-code

# åˆ›å»ºç­–ç•¥æ–‡ä»¶
sudo tee /etc/claude-code/policies.json << 'EOF'
{
  "permissions": {
    "allow": [
      "Read(/home/*/projects/*)",
      "Write(/home/*/projects/*/src/**/*)",
      "Bash(npm test)",
      "Bash(make test)",
      "Bash(git status)"
    ]
  },

  "env": {
    "ANTHROPIC_BASE_URL": "https://api.company.com",
    "CLAUDE_CODE_ENABLE_TELEMETRY": "0",
    "HTTP_PROXY": "http://proxy.company.com:8080",
    "HTTPS_PROXY": "http://proxy.company.com:8080"
  },

  "security": {
    "requireKeyAuth": true,
    "maxSessionDuration": 28800,
    "idleTimeout": 1800
  }
}
EOF

# è®¾ç½®æƒé™
sudo chown -R root:root /etc/claude-code
sudo chmod 755 /etc/claude-code
sudo chmod 644 /etc/claude-code/policies.json
```

### 3.2 APIå¯†é’¥ç®¡ç†

#### å¯†é’¥åŠ©æ‰‹è„šæœ¬

```bash
#!/bin/bash
# /usr/local/bin/company-key-helper.sh

# ä»å…¬å¸å¯†é’¥ç®¡ç†ç³»ç»Ÿè·å–ä¸´æ—¶å¯†é’¥
RESPONSE=$(curl -s -X POST \
  -H "Authorization: Bearer $COMP_SERVICE_TOKEN" \
  -H "Content-Type: application/json" \
  https://keymanager.company.com/api/keys/claude \
  -d '{
    "ttl": 3600,
    "scopes": ["read", "write"]
  }')

# è§£æå“åº”å¹¶è¿”å›å¯†é’¥
echo $RESPONSE | jq -r '.apiKey // empty'

# é”™è¯¯å¤„ç†
if [ $? -ne 0 ]; then
  echo "Error: Failed to obtain API key" >&2
  exit 1
fi
```

#### ä¼ä¸šå¯†é’¥è½®æ¢

```bash
#!/bin/bash
# /usr/local/bin/rotate-claude-keys.sh

LOG_FILE="/var/log/claude-key-rotation.log"

log() {
  echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" >> $LOG_FILE
}

# è·å–å½“å‰å¯†é’¥ä¿¡æ¯
CURRENT_KEY_INFO=$(curl -s -H "Authorization: Bearer $ADMIN_TOKEN" \
  https://keymanager.company.com/api/keys/current)

log "Starting key rotation..."

# ç”Ÿæˆæ–°å¯†é’¥
NEW_KEY_RESPONSE=$(curl -s -X POST \
  -H "Authorization: Bearer $ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  https://keymanager.company.com/api/keys \
  -d '{"ttl": 86400, "scopes": ["read", "write"]}')

NEW_KEY=$(echo $NEW_KEY_RESPONSE | jq -r '.apiKey')

# æ›´æ–°é…ç½®
sudo sed -i "s/ANTHROPIC_AUTH_TOKEN=.*/ANTHROPIC_AUTH_TOKEN=\"$NEW_KEY\"/" \
  /etc/environment

log "Key rotation completed successfully"

# é€šçŸ¥ç®¡ç†å‘˜
curl -s -X POST \
  -H "Content-Type: application/json" \
  https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK \
  -d "{\"text\":\"Claude Code API key rotated successfully\"}"
```

### 3.3 ç›‘æ§å’Œå®¡è®¡

#### å®¡è®¡æ—¥å¿—é…ç½®

```json
{
  "audit": {
    "enabled": true,
    "logPath": "/var/log/claude-code/audit.log",
    "logLevel": "info",
    "logFormat": "json",
    "maxFileSize": "100MB",
    "maxFiles": 10,
    "events": [
      "session_start",
      "session_end",
      "command_execution",
      "file_access",
      "permission_change",
      "error_occurred"
    ]
  }
}
```

#### ç›‘æ§è„šæœ¬

```bash
#!/bin/bash
# /usr/local/bin/monitor-claude-usage.sh

ALERT_THRESHOLD=1000  # æ¯æ—¥APIè°ƒç”¨é˜ˆå€¼
LOG_FILE="/var/log/claude-usage.log"
WEBHOOK_URL="https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK"

# ç»Ÿè®¡ä»Šæ—¥ä½¿ç”¨é‡
TODAY_USAGE=$(grep $(date +%Y-%m-%d) /var/log/claude-code/audit.log | wc -l)

if [ $TODAY_USAGE -gt $ALERT_THRESHOLD ]; then
  MESSAGE="âš ï¸ Claude Code usage alert: $TODAY_USAGE API calls today (threshold: $ALERT_THRESHOLD)"

  # å‘é€å‘Šè­¦
  curl -X POST -H 'Content-type: application/json' \
    --data "{\"text\":\"$MESSAGE\"}" \
    $WEBHOOK_URL

  echo "[$(date)] Usage alert sent: $TODAY_USAGE calls" >> $LOG_FILE
fi

# ç”Ÿæˆä½¿ç”¨æŠ¥å‘Š
cat > /var/www/reports/claude-usage-$(date +%Y%m%d).json << EOF
{
  "date": "$(date +%Y-%m-%d)",
  "totalCalls": $TODAY_USAGE,
  "users": $(grep $(date +%Y-%m-%d) /var/log/claude-code/audit.log | jq -s '. | group_by(.user) | map({user: .[0].user, count: length})'),
  "topCommands": $(grep $(date +%Y-%m-%d) /var/log/claude-code/audit.log | jq -s '. | group_by(.command) | map({command: .[0].command, count: length}) | sort_by(.count) | reverse'),
  "errors": $(grep $(date +%Y-%m-%d) /var/log/claude-code/audit.log | jq 'select(.type == "error") | length')
}
EOF
```

## 4. é…ç½®ä¼˜å…ˆçº§è¯¦è§£

### 4.1 ä¼˜å…ˆçº§å±‚æ¬¡

```
1. å‘½ä»¤è¡Œå‚æ•°          (æœ€é«˜ä¼˜å…ˆçº§)
2. ç¯å¢ƒå˜é‡
3. é¡¹ç›®æœ¬åœ°é…ç½®        (.claude/settings.local.json)
4. é¡¹ç›®å…±äº«é…ç½®        (.claude/settings.json)
5. ç”¨æˆ·å…¨å±€é…ç½®        (~/.claude/settings.json)
6. ä¼ä¸šç­–ç•¥é…ç½®        (æœ€ä½ä¼˜å…ˆçº§)
```

### 4.2 é…ç½®ç»§æ‰¿ç¤ºä¾‹

#### åœºæ™¯ï¼šå¤šå±‚é…ç½®ç»§æ‰¿

```json
// ä¼ä¸šç­–ç•¥ - æœ€ä½ä¼˜å…ˆçº§
{
  "permissions": {
    "allow": ["Read(*)"],
    "deny": ["Bash(sudo*)", "Write(/etc/*)"]
  },
  "env": {
    "ANTHROPIC_BASE_URL": "https://api.company.com",
    "DISABLE_TELEMETRY": "1"
  }
}
```

```json
// ç”¨æˆ·å…¨å±€é…ç½®
{
  "permissions": {
    "allow": ["Write(*.md)", "Write(*.txt)"],  // è¿½åŠ æƒé™
    "deny": ["Bash(rm*)"]  // è¿½åŠ ç¦æ­¢
  },
  "env": {
    "EDITOR": "code",  // æ–°å¢ç¯å¢ƒå˜é‡
    "ANTHROPIC_BASE_URL": "https://api.personal.com"  // è¦†ç›–ä¼ä¸šé…ç½®
  }
}
```

```json
// é¡¹ç›®å…±äº«é…ç½®
{
  "permissions": {
    "allow": ["Bash(npm run*)"],  // é¡¹ç›®ç‰¹å®šæƒé™
    "deny": ["Write(production.env)"]  // é¡¹ç›®ç‰¹å®šç¦æ­¢
  },
  "env": {
    "NODE_ENV": "development",  // é¡¹ç›®ç¯å¢ƒ
    "PROJECT_NAME": "my-app"
  }
}
```

```json
// é¡¹ç›®æœ¬åœ°é…ç½® - æœ€é«˜ä¼˜å…ˆçº§
{
  "environmentVariables": [
    {
      "name": "ANTHROPIC_AUTH_TOKEN",
      "value": "personal-api-key"  // ä¸ªäººå¯†é’¥
    }
  ],
  "permissions": {
    "allow": ["Bash(npm run deploy)"]  // è¦†ç›–é¡¹ç›®ç¦æ­¢
  }
}
```

#### æœ€ç»ˆç”Ÿæ•ˆé…ç½®

```json
{
  "permissions": {
    "allow": [
      "Read(*)",                    // æ¥è‡ªä¼ä¸š
      "Write(*.md)",                // æ¥è‡ªç”¨æˆ·
      "Write(*.txt)",               // æ¥è‡ªç”¨æˆ·
      "Bash(npm run*)",             // æ¥è‡ªé¡¹ç›®
      "Bash(npm run deploy)"        // æ¥è‡ªæœ¬åœ°ï¼ˆè¦†ç›–é¡¹ç›®ç¦æ­¢ï¼‰
    ],
    "deny": [
      "Bash(sudo*)",                // æ¥è‡ªä¼ä¸š
      "Write(/etc/*)",              // æ¥è‡ªä¼ä¸š
      "Bash(rm*)",                  // æ¥è‡ªç”¨æˆ·
      "Write(production.env)"       // æ¥è‡ªé¡¹ç›®
    ]
  },
  "env": {
    "ANTHROPIC_BASE_URL": "https://api.personal.com",  // ç”¨æˆ·é…ç½®è¦†ç›–ä¼ä¸š
    "DISABLE_TELEMETRY": "1",                         // æ¥è‡ªä¼ä¸š
    "EDITOR": "code",                                 // æ¥è‡ªç”¨æˆ·
    "NODE_ENV": "development",                        // æ¥è‡ªé¡¹ç›®
    "PROJECT_NAME": "my-app"                          // æ¥è‡ªé¡¹ç›®
  },
  "environmentVariables": [
    {
      "name": "ANTHROPIC_AUTH_TOKEN",
      "value": "personal-api-key"                     // æ¥è‡ªæœ¬åœ°é…ç½®
    }
  ]
}
```

### 4.3 åŠ¨æ€ä¼˜å…ˆçº§è°ƒæ•´

#### è¿è¡Œæ—¶é…ç½®è¦†ç›–

```bash
# å‘½ä»¤è¡Œå‚æ•°æœ€é«˜ä¼˜å…ˆçº§
claude --model claude-opus-4 \
       --allowedTools "Bash(npm*)" "Read(*)" \
       --disallowedTools "Write(*)" \
       "åˆ†æé¡¹ç›®ç»“æ„"

# ä¸´æ—¶ç¯å¢ƒå˜é‡è¦†ç›–
ANTHROPIC_MODEL="claude-opus-4" \
claude "æ‰§è¡Œå¤æ‚ä»»åŠ¡"
```

#### é…ç½®éªŒè¯å‘½ä»¤

```bash
# æŸ¥çœ‹æœ€ç»ˆç”Ÿæ•ˆçš„é…ç½®
claude /config

# æŸ¥çœ‹ç‰¹å®šé…ç½®é¡¹
claude /config permissions

# æŸ¥çœ‹ç¯å¢ƒå˜é‡
claude /config env
```

## 5. æœ€ä½³å®è·µå»ºè®®

### 5.1 å®‰å…¨é…ç½®

#### æ•æ„Ÿä¿¡æ¯ä¿æŠ¤

```json
{
  // âŒ é”™è¯¯ï¼šç¡¬ç¼–ç å¯†é’¥
  "env": {
    "ANTHROPIC_AUTH_TOKEN": "sk-ant-api03-..."
  }
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨å¯†é’¥åŠ©æ‰‹
{
  "apiKeyHelper": "/usr/local/bin/secure-key-helper.sh"
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨æœ¬åœ°é…ç½®æ–‡ä»¶
// .claude/settings.local.json (è¢«gitå¿½ç•¥)
{
  "environmentVariables": [
    {
      "name": "ANTHROPIC_AUTH_TOKEN",
      "value": "sk-ant-api03-..."
    }
  ]
}
```

#### æƒé™æœ€å°åŒ–åŸåˆ™

```json
{
  // âŒ è¿‡äºå®½æ¾çš„æƒé™
  "permissions": {
    "allow": ["Bash(*)", "Write(*)"]
  }
}

// âœ… ç²¾ç¡®çš„æƒé™æ§åˆ¶
{
  "permissions": {
    "allow": [
      "Bash(npm run test)",
      "Bash(npm run build)",
      "Bash(git status)",
      "Read(src/**/*)",
      "Write(src/**/*.ts)",
      "Write(src/**/*.js)"
    ]
  }
}
```

### 5.2 æ€§èƒ½ä¼˜åŒ–

#### Tokenä½¿ç”¨ä¼˜åŒ–

```json
{
  "env": {
    // é™åˆ¶è¾“å‡ºé•¿åº¦å‡å°‘Tokenä½¿ç”¨
    "CLAUDE_CODE_MAX_OUTPUT_TOKENS": "4096",

    // çŸ­ä»»åŠ¡ä½¿ç”¨å°æ¨¡å‹
    "ANTHROPIC_DEFAULT_HAIKU_MODEL": "glm-4.5-air",

    // å¯ç”¨ä¼šè¯å‹ç¼©
    "CLAUDE_AUTO_COMPRESS_THRESHOLD": "50000"
  }
}
```

#### ç½‘ç»œä¼˜åŒ–

```json
{
  "env": {
    // è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´
    "BASH_DEFAULT_TIMEOUT_MS": "120000",

    // ä½¿ç”¨æœ¬åœ°é•œåƒåŠ é€Ÿ
    "NPM_REGISTRY": "https://registry.npmmirror.com",

    // é…ç½®ä»£ç†
    "HTTP_PROXY": "http://proxy:8080"
  }
}
```

### 5.3 å›¢é˜Ÿåä½œ

#### æ ‡å‡†åŒ–é¡¹ç›®é…ç½®

```json
// .claude/settings.json (æäº¤åˆ°git)
{
  "team": {
    "name": "frontend-team",
    "version": "1.0.0",
    "lastUpdated": "2025-12-22"
  },

  "permissions": {
    "allow": [
      "Bash(npm run lint)",
      "Bash(npm run test)",
      "Bash(npm run build)"
    ]
  },

  "env": {
    "NODE_ENV": "development",
    "TS_NODE_PROJECT": "tsconfig.json"
  },

  "scripts": {
    "setup": "npm install && npm run build",
    "test": "npm run test && npm run lint",
    "deploy": "npm run build && npm run deploy:staging"
  }
}
```

#### ä¸ªäººé…ç½®æ¨¡æ¿

```json
// ~/.claude/settings.json.template
{
  "personal": {
    "name": "{{USER_NAME}}",
    "email": "{{USER_EMAIL}}"
  },

  "env": {
    "EDITOR": "code",
    "GIT_AUTHOR_NAME": "{{USER_NAME}}",
    "GIT_AUTHOR_EMAIL": "{{USER_EMAIL}}"
  }
}
```

### 5.4 ç»´æŠ¤å’Œæ›´æ–°

#### é…ç½®ç‰ˆæœ¬æ§åˆ¶

```bash
# åˆ›å»ºé…ç½®å¤‡ä»½
cp ~/.claude/settings.json ~/.claude/settings.json.backup.$(date +%Y%m%d)

# é…ç½®å˜æ›´è®°å½•
echo "$(date): Updated Claude Code configuration" >> ~/.claude/changelog.md
```

#### å®šæœŸç»´æŠ¤è„šæœ¬

```bash
#!/bin/bash
# claude-maintenance.sh

echo "å¼€å§‹Claude Codeç»´æŠ¤..."

# æ¸…ç†ç¼“å­˜
find ~/.claude/cache -name "*.tmp" -mtime +7 -delete

# æ›´æ–°é…ç½®æ¨¡æ¿
curl -s https://raw.githubusercontent.com/company/claude-config/main/settings.json.template \
  -o ~/.claude/settings.json.template

# éªŒè¯é…ç½®
claude /doctor

# ç”Ÿæˆä½¿ç”¨æŠ¥å‘Š
claude -p "ç”Ÿæˆæœ¬æœˆä½¿ç”¨æŠ¥å‘Š" > ~/claude-report-$(date +%Y%m).md

echo "ç»´æŠ¤å®Œæˆ"
```

## ä¸‹ä¸€æ­¥

é…ç½®å®Œæˆåï¼Œå»ºè®®ç»§ç»­å­¦ä¹ ï¼š

- [Claude Codeé«˜çº§è‡ªåŠ¨åŒ–æŠ€å·§](./0113.claude-code-automation.md)
- [Claude Codeæ•…éšœæ’é™¤æŒ‡å—](./0114.claude-code-troubleshooting.md)

## å‚è€ƒèµ„æº

- [Claude Codeé…ç½®æ–‡æ¡£](https://docs.claude.com/en/docs/claude-code/configuration)
- [ä¼ä¸šéƒ¨ç½²æŒ‡å—](https://docs.claude.com/en/docs/claude-code/enterprise)
- [å®‰å…¨æœ€ä½³å®è·µ](https://docs.claude.com/en/docs/claude-code/security)

> ğŸ’¡ **æç¤º**: ä½¿ç”¨ `claude /config` å‘½ä»¤å¯ä»¥æŸ¥çœ‹å½“å‰ç”Ÿæ•ˆçš„å®Œæ•´é…ç½®ã€‚å®šæœŸè¿è¡Œ `claude /doctor` æ£€æŸ¥é…ç½®å¥åº·çŠ¶æ€ï¼Œç¡®ä¿ç³»ç»Ÿæ­£å¸¸è¿è¡Œã€‚