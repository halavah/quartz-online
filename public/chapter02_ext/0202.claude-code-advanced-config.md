# Claude Code é«˜çº§é…ç½®æŠ€å·§

> æ·±å…¥Claude Codeé…ç½®ï¼ŒåŒ…å«VSCodeæ’ä»¶é…ç½®ã€GLMæ¨¡å‹é…ç½®ã€å¤šç¯å¢ƒç®¡ç†å’Œä¼ä¸šçº§éƒ¨ç½²

## ç›®å½•å¯¼èˆª

1. [VSCodeæ’ä»¶2.0+é…ç½®](#1-vscodeæ’ä»¶20é…ç½®)
2. [GLMæ¨¡å‹é…ç½®æ–¹æ¡ˆ](#2-glmæ¨¡å‹é…ç½®æ–¹æ¡ˆ)
3. [å¤šç¯å¢ƒé…ç½®ç®¡ç†](#3-å¤šç¯å¢ƒé…ç½®ç®¡ç†)
4. [é…ç½®ä¼˜å…ˆçº§è¯¦è§£](#4-é…ç½®ä¼˜å…ˆçº§è¯¦è§£)
5. [ä¼ä¸šçº§éƒ¨ç½²](#5-ä¼ä¸šçº§éƒ¨ç½²)

## 1. VSCodeæ’ä»¶2.0+é…ç½®

### 1.1 è·³è¿‡ç™»å½•é…ç½®

VSCodeæ’ä»¶å‡çº§åˆ°2.0ç‰ˆæœ¬åï¼Œéœ€è¦ç‰¹å®šé…ç½®æ‰èƒ½è·³è¿‡ç™»å½•ï¼š

#### æ­¥éª¤1: åˆ›å»ºè§¦å‘å™¨æ–‡ä»¶

åˆ›å»º `~/.claude/config.json` æ–‡ä»¶ï¼š

```json
{
  "api_key": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
}
```

> âš ï¸ **æ³¨æ„**: è¿™ä¸ªæ–‡ä»¶æ˜¯è§¦å‘å™¨ï¼ŒAPI keyå¯ä»¥ä»»æ„å¡«å†™ï¼Œä¸»è¦ä½œç”¨æ˜¯æ¿€æ´»æ’ä»¶çš„ç¯å¢ƒå˜é‡è¯»å–åŠŸèƒ½ã€‚

#### æ­¥éª¤2: é…ç½®VSCodeè®¾ç½®

åœ¨VSCodeçš„ `settings.json` ä¸­æ·»åŠ ï¼š

```json
{
  "claude-code.environmentVariables": [
    {
      "name": "ANTHROPIC_AUTH_TOKEN",
      "value": "ä½ çš„å®é™…APIå¯†é’¥"
    },
    {
      "name": "ANTHROPIC_BASE_URL",
      "value": "https://open.bigmodel.cn/api/anthropic"
    }
  ]
}
```

### 1.2 å®Œæ•´çš„VSCodeé…ç½®ç¤ºä¾‹

```json
{
  // Claude Code æ’ä»¶é…ç½®
  "claude-code.environmentVariables": [
    {
      "name": "ANTHROPIC_AUTH_TOKEN",
      "value": "b04049f4fef843a3999b5fc69c7cfe5d.lDUHLQUbMv61LYE1"
    },
    {
      "name": "ANTHROPIC_BASE_URL",
      "value": "https://open.bigmodel.cn"
    },
    {
      "name": "ANTHROPIC_DEFAULT_SONNET_MODEL",
      "value": "glm-4.6"
    },
    {
      "name": "ANTHROPIC_DEFAULT_HAIKU_MODEL",
      "value": "glm-4.5-air"
    },
    {
      "name": "ANTHROPIC_DEFAULT_OPUS_MODEL",
      "value": "glm-4.6"
    }
  ],

  // å…¶ä»–VSCodeé…ç½®
  "editor.formatOnSave": true,
  "files.autoSave": "afterDelay"
}
```

## 2. GLMæ¨¡å‹é…ç½®æ–¹æ¡ˆ

### 2.1 GLMé…ç½®å‚æ•°

ä½¿ç”¨æ™ºè°±GLMæ¨¡å‹æ—¶çš„å®Œæ•´é…ç½®ï¼š

```bash
# åŸºç¡€é…ç½®
export ANTHROPIC_BASE_URL="https://open.bigmodel.cn/api/anthropic"
export ANTHROPIC_AUTH_TOKEN="ä½ çš„æ™ºè°±APIå¯†é’¥"

# æ¨¡å‹æ˜ å°„ï¼ˆå¯é€‰ï¼‰
export ANTHROPIC_DEFAULT_HAIKU_MODEL="glm-4.5-air"
export ANTHROPIC_DEFAULT_SONNET_MODEL="glm-4.6"
export ANTHROPIC_DEFAULT_OPUS_MODEL="glm-4.6"
export ANTHROPIC_MODEL="GLM-4.6"
```

### 2.2 æ–¹æ¡ˆä¸€ï¼šé¡¹ç›®çº§é…ç½®ï¼ˆæ¨èï¼‰

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.claude/settings.local.json`ï¼š

```json
{
  "environmentVariables": [
    {
      "name": "ANTHROPIC_AUTH_TOKEN",
      "value": "b04049f4fef843a3999b5fc69c7cfe5d.lDUHLQUbMv61LYE1"
    },
    {
      "name": "ANTHROPIC_BASE_URL",
      "value": "https://open.bigmodel.cn/api/anthropic"
    },
    {
      "name": "ANTHROPIC_DEFAULT_SONNET_MODEL",
      "value": "glm-4.6"
    },
    {
      "name": "ANTHROPIC_DEFAULT_HAIKU_MODEL",
      "value": "glm-4.5-air"
    }
  ]
}
```

**ä¼˜ç‚¹**:
- ä¼˜å…ˆçº§æœ€é«˜ï¼Œç¡®ä¿ç”Ÿæ•ˆ
- ä¸å½±å“å…¶ä»–é¡¹ç›®
- è‡ªåŠ¨è¢« git å¿½ç•¥ï¼Œå¯†é’¥å®‰å…¨

### 2.3 æ–¹æ¡ˆäºŒï¼šShellç¯å¢ƒå˜é‡

åœ¨ `~/.zshrc` æˆ– `~/.bashrc` ä¸­æ·»åŠ ï¼š

```bash
# CC-Switch: Claude Code é…ç½®åˆ‡æ¢
export ANTHROPIC_AUTH_TOKEN="b04049f4fef843a3999b5fc69c7cfe5d.lDUHLQUbMv61LYE1"
export ANTHROPIC_BASE_URL="https://open.bigmodel.cn/api/anthropic"
export ANTHROPIC_DEFAULT_SONNET_MODEL="glm-4.6"
export ANTHROPIC_DEFAULT_HAIKU_MODEL="glm-4.5-air"

# å¯é€‰ï¼šå…³é—­éå¿…è¦æµé‡
export CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC=1
```

**ä¼˜ç‚¹**:
- æœ€ç›´æ¥ï¼ŒCLIå’Œæ‰©å±•éƒ½èƒ½è¯†åˆ«
- é…ç½®ç®€å•ï¼Œæ˜“äºç®¡ç†

**ç¼ºç‚¹**:
- éœ€è¦é‡å¯ç»ˆç«¯/VSCode
- å…¨å±€æ±¡æŸ“ç¯å¢ƒå˜é‡

## 3. å¤šç¯å¢ƒé…ç½®ç®¡ç†

### 3.1 é…ç½®æ–‡ä»¶ä½ç½®å’Œä¼˜å…ˆçº§

Claude CodeæŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§åŠ è½½é…ç½®ï¼š

1. **å‘½ä»¤è¡Œå‚æ•°** (æœ€é«˜ä¼˜å…ˆçº§)
2. **é¡¹ç›®æœ¬åœ°é…ç½®** `.claude/settings.local.json`
3. **é¡¹ç›®å…±äº«é…ç½®** `.claude/settings.json`
4. **ç”¨æˆ·å…¨å±€é…ç½®** `~/.claude/settings.json`
5. **ä¼ä¸šç­–ç•¥é…ç½®** (æœ€ä½ä¼˜å…ˆçº§)

### 3.2 é¡¹ç›®çº§é…ç½®ç¤ºä¾‹

#### å…±äº«é…ç½® (`.claude/settings.json`)

```json
{
  "permissions": {
    "allow": [
      "Bash(npm run lint)",
      "Bash(npm run test:*)",
      "Read(*.md)"
    ]
  },
  "env": {
    "NODE_ENV": "development",
    "PROJECT_NAME": "my-app"
  }
}
```

#### æœ¬åœ°é…ç½® (`.claude/settings.local.json`)

```json
{
  "environmentVariables": [
    {
      "name": "ANTHROPIC_AUTH_TOKEN",
      "value": "ä¸ªäººAPIå¯†é’¥"
    }
  ],
  "permissions": {
    "allow": [
      "Bash(npm run dev)"
    ]
  }
}
```

### 3.3 å¤šå›¢é˜Ÿåä½œé…ç½®

```json
{
  "team": "frontend-team",
  "env": {
    "TEAM_SLACK_WEBHOOK": "https://hooks.slack.com/...",
    "CODE_REVIEW_ASSIGN": "@senior-dev"
  },
  "permissions": {
    "allow": [
      "Bash(git commit -m *)",
      "Bash(npm run format)"
    ],
    "deny": [
      "Bash(git push --force)",
      "Bash(rm -rf *)"
    ]
  }
}
```

## 4. é…ç½®ä¼˜å…ˆçº§è¯¦è§£

### 4.1 é…ç½®å†²çªå¤„ç†

å½“å¤šä¸ªé…ç½®æºå­˜åœ¨å†²çªæ—¶ï¼ŒClaude CodeæŒ‰ä»¥ä¸‹é¡ºåºåº”ç”¨ï¼š

| ä¼˜å…ˆçº§ | é…ç½®æº | è¯´æ˜ |
|--------|--------|------|
| 1 | å‘½ä»¤è¡Œå‚æ•° | `--model`, `--api-key` ç­‰ |
| 2 | ç¯å¢ƒå˜é‡ | `ANTHROPIC_*` ç³»åˆ—å˜é‡ |
| 3 | é¡¹ç›®æœ¬åœ°é…ç½® | `.claude/settings.local.json` |
| 4 | é¡¹ç›®å…±äº«é…ç½® | `.claude/settings.json` |
| 5 | ç”¨æˆ·å…¨å±€é…ç½® | `~/.claude/settings.json` |
| 6 | é»˜è®¤é…ç½® | Claude Codeå†…ç½®é»˜è®¤å€¼ |

### 4.2 é…ç½®ç»§æ‰¿å’Œè¦†ç›–

```json
// å…¨å±€é…ç½® ~/.claude/settings.json
{
  "permissions": {
    "allow": ["Read(*)"],
    "deny": ["Bash(rm *)"]
  },
  "env": {
    "EDITOR": "code"
  }
}

// é¡¹ç›®é…ç½® .claude/settings.json
{
  "permissions": {
    // ç»§æ‰¿å…¨å±€allowï¼Œæ·»åŠ æ–°çš„æƒé™
    "allow": ["Bash(npm run *)"]
  },
  // è¦†ç›–å…¨å±€EDITOR
  "env": {
    "EDITOR": "vim"
  }
}

// æœ€ç»ˆç”Ÿæ•ˆçš„é…ç½®
{
  "permissions": {
    "allow": ["Read(*)", "Bash(npm run *)"],
    "deny": ["Bash(rm *)"]
  },
  "env": {
    "EDITOR": "vim"  // é¡¹ç›®é…ç½®è¦†ç›–äº†å…¨å±€é…ç½®
  }
}
```

## 5. ä¼ä¸šçº§éƒ¨ç½²

### 5.1 ä¼ä¸šç­–ç•¥é…ç½®

ä¼ä¸šå¯ä»¥é€šè¿‡ç­–ç•¥æ–‡ä»¶ç»Ÿä¸€ç®¡ç†é…ç½®ï¼š

#### macOS

```json
// /Library/Application Support/ClaudeCode/policies.json
{
  "permissions": {
    "allow": [
      "Read(*.js)",
      "Read(*.ts)",
      "Read(*.md)",
      "Bash(npm run test)",
      "Bash(npm run build)"
    ],
    "deny": [
      "Bash(curl *)",
      "Bash(wget *)",
      "Bash(rm -rf *)"
    ]
  },
  "env": {
    "ANTHROPIC_BASE_URL": "https://company-proxy.example.com/api",
    "CLAUDE_CODE_ENABLE_TELEMETRY": "0",
    "DISABLE_TELEMETRY": "1"
  },
  "cleanupPeriodDays": 7,
  "includeCoAuthoredBy": true
}
```

#### Linux

```bash
# /etc/claude-code/policies.json
sudo mkdir -p /etc/claude-code
sudo tee /etc/claude-code/policies.json << EOF
{
  "permissions": {
    "allow": ["Read(/company/project/*)"],
    "deny": ["Write(/etc/*)", "Bash(sudo *)"]
  },
  "env": {
    "ANTHROPIC_BASE_URL": "https://api.company.com",
    "COMPANY_POLICY": "strict"
  }
}
EOF
```

### 5.2 ä»£ç†å’Œç½‘å…³é…ç½®

#### HTTPä»£ç†é…ç½®

```bash
# ç³»ç»Ÿçº§ä»£ç†
export HTTP_PROXY="http://proxy.company.com:8080"
export HTTPS_PROXY="http://proxy.company.com:8080"
export NO_PROXY="localhost,127.0.0.1,.company.com"

# Claude Codeä¸“ç”¨ä»£ç†
export ANTHROPIC_BASE_URL="https://api-gateway.company.com/anthropic"
```

#### é…ç½®æ–‡ä»¶ä¸­çš„ä»£ç†è®¾ç½®

```json
{
  "env": {
    "HTTP_PROXY": "http://proxy.company.com:8080",
    "HTTPS_PROXY": "http://proxy.company.com:8080",
    "ANTHROPIC_BASE_URL": "https://api-gateway.company.com/anthropic",
    "ANTHROPIC_API_KEY_HELPER": "/usr/local/bin/company-key-helper.sh"
  }
}
```

### 5.3 APIå¯†é’¥ç®¡ç†

#### ä½¿ç”¨å¯†é’¥åŠ©æ‰‹è„šæœ¬

```bash
#!/bin/bash
# /usr/local/bin/company-key-helper.sh

# ä»å…¬å¸å¯†é’¥ç®¡ç†ç³»ç»Ÿè·å–ä¸´æ—¶å¯†é’¥
RESPONSE=$(curl -s -X POST \
  -H "Authorization: Bearer $COMP_SERVICE_TOKEN" \
  https://keymanager.company.com/api/keys/claude)

echo $RESPONSE | jq -r '.apiKey'
```

é…ç½®ä½¿ç”¨ï¼š

```json
{
  "apiKeyHelper": "/usr/local/bin/company-key-helper.sh",
  "env": {
    "COMP_SERVICE_TOKEN": "your-service-token"
  }
}
```

### 5.4 å®¡è®¡å’Œåˆè§„

#### å¯ç”¨å®¡è®¡æ—¥å¿—

```json
{
  "env": {
    "CLAUDE_CODE_ENABLE_AUDIT_LOG": "1",
    "AUDIT_LOG_PATH": "/var/log/claude-code/audit.log",
    "AUDIT_LOG_FORMAT": "json"
  }
}
```

#### ç¦ç”¨æ•æ„ŸåŠŸèƒ½

```json
{
  "env": {
    "DISABLE_BUG_COMMAND": "1",
    "DISABLE_ERROR_REPORTING": "1",
    "DISABLE_TELEMETRY": "1",
    "CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC": "1"
  }
}
```

## æœ€ä½³å®è·µ

### 1. å®‰å…¨é…ç½®

- å§‹ç»ˆä½¿ç”¨ `settings.local.json` å­˜å‚¨æ•æ„Ÿä¿¡æ¯
- å®šæœŸè½®æ¢APIå¯†é’¥
- é™åˆ¶æƒé™èŒƒå›´ï¼Œéµå¾ªæœ€å°æƒé™åŸåˆ™
- å¯ç”¨å®¡è®¡æ—¥å¿—

### 2. æ€§èƒ½ä¼˜åŒ–

```json
{
  "env": {
    "BASH_DEFAULT_TIMEOUT_MS": "300000",
    "CLAUDE_CODE_MAX_OUTPUT_TOKENS": "8192",
    "MCP_TOOL_TIMEOUT": "60000"
  }
}
```

### 3. å›¢é˜Ÿåä½œ

- ä½¿ç”¨é¡¹ç›®çº§å…±äº«é…ç½®ç»Ÿä¸€å›¢é˜Ÿè§„èŒƒ
- å»ºç«‹é…ç½®ç‰ˆæœ¬æ§åˆ¶æµç¨‹
- å®šæœŸå®¡æŸ¥å’Œæ›´æ–°æƒé™è®¾ç½®

## ä¸‹ä¸€æ­¥

é…ç½®å®Œæˆåï¼Œå»ºè®®ç»§ç»­é˜…è¯»ï¼š

- [Claude Codeå®ç”¨æ“ä½œæ‰‹å†Œ](./0108.claude-code-operation-manual.md)
- [Claude Code CLIå®Œå…¨æŒ‡å—](./0109.claude-code-cli-guide.md)

## å‚è€ƒèµ„æº

- [Claude Codeé…ç½®æ–‡æ¡£](https://docs.claude.com/en/docs/claude-code/configuration)
- [ä¼ä¸šéƒ¨ç½²æŒ‡å—](https://docs.claude.com/en/docs/claude-code/enterprise)
- [å®‰å…¨æœ€ä½³å®è·µ](https://docs.claude.com/en/docs/claude-code/security)

> ğŸ’¡ **æç¤º**: é…ç½®æ›´æ”¹åï¼Œä½¿ç”¨ `claude /config` éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®åŠ è½½ï¼Œç¡®ä¿æ‰€æœ‰è®¾ç½®æŒ‰é¢„æœŸå·¥ä½œã€‚