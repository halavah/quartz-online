# 05. Vercel éƒ¨ç½²è¯¦è§£

## ğŸš€ å¿«é€ŸæŸ¥çœ‹éƒ¨ç½²çŠ¶æ€

### å®æ—¶éƒ¨ç½²é“¾æ¥
- **Vercel é¡¹ç›®**: https://vercel.com/halavah/quartz-online
- **éƒ¨ç½²æ—¥å¿—**: https://vercel.com/halavah/quartz-online/deployments
- **ç”Ÿäº§ç«™ç‚¹**: https://quartz-online.vercel.app

### æœ¬åœ°å‘½ä»¤
```bash
# æŸ¥çœ‹æœ€æ–°éƒ¨ç½²æ—¥å¿—
npm run vercel:logs

# æŸ¥çœ‹é¡¹ç›®çŠ¶æ€
npm run vercel

# æ‰‹åŠ¨è§¦å‘éƒ¨ç½²
npm run deploy
```

### å½“å‰éƒ¨ç½²é…ç½®
- **æ¡†æ¶**: Next.js 15.5.9
- **Node.js**: 20.10.0
- **å®‰è£…å‘½ä»¤**: `npm ci`
- **æ„å»ºå‘½ä»¤**: `npm run build`

---

## ğŸ¯ ä¸ºä»€ä¹ˆé€‰æ‹© Vercel

### æ ¸å¿ƒä¼˜åŠ¿
- **é›¶é…ç½®éƒ¨ç½²** - è‡ªåŠ¨æ£€æµ‹ Next.js é¡¹ç›®ï¼Œæ— éœ€å¤æ‚é…ç½®
- **å…¨çƒ CDN** - è¾¹ç¼˜ç½‘ç»œåŠ é€Ÿï¼Œå…¨çƒè®¿é—®é€Ÿåº¦ä¼˜åŒ–
- **è‡ªåŠ¨ HTTPS** - å…è´¹ SSL è¯ä¹¦ï¼Œè‡ªåŠ¨ç»­æœŸ
- **Git é›†æˆ** - æ¨é€ä»£ç è‡ªåŠ¨éƒ¨ç½²
- **é¢„è§ˆéƒ¨ç½²** - æ¯ä¸ª PR è‡ªåŠ¨ç”Ÿæˆé¢„è§ˆé“¾æ¥
- **æ€§èƒ½åˆ†æ** - å†…ç½® Web Vitals ç›‘æ§

### å…è´¹é¢åº¦
- 100GB å¸¦å®½/æœˆ
- 100 æ¬¡æ„å»º/æœˆ
- æ— é™é™æ€ç«™ç‚¹
- æ— é™é¡¹ç›®
- æ— é™å›¢é˜Ÿåä½œ

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³•ä¸€ï¼šé€šè¿‡ GitHub é›†æˆï¼ˆæ¨èï¼‰

1. **å‡†å¤‡å·¥ä½œ**
   ```bash
   # ç¡®ä¿ Git å·²åˆå§‹åŒ–
   git init
   git add .
   git commit -m "Initial commit"

   # æ¨é€åˆ° GitHub
   git remote add origin https://github.com/your-username/your-repo.git
   git push -u origin main
   ```

2. **éƒ¨ç½²æ­¥éª¤**
   - è®¿é—® [vercel.com](https://vercel.com)
   - ç‚¹å‡» "Sign up" ä½¿ç”¨ GitHub è´¦å·ç™»å½•
   - ç‚¹å‡» "New Project"
   - é€‰æ‹© GitHub ä»“åº“
   - Vercel è‡ªåŠ¨æ£€æµ‹ Next.js æ¡†æ¶
   - ç‚¹å‡» "Deploy"

3. **å®Œæˆéƒ¨ç½²**
   - ç­‰å¾… 1-2 åˆ†é’Ÿéƒ¨ç½²å®Œæˆ
   - è·å¾— `.vercel.app` åŸŸå
   - å¯è‡ªå®šä¹‰åŸŸå

### æ–¹æ³•äºŒï¼šä½¿ç”¨ Vercel CLI

1. **å®‰è£… CLI**
   ```bash
   npm i -g vercel
   ```

2. **ç™»å½•**
   ```bash
   vercel login
   # é€‰æ‹© GitHub/GitLab/Email ç™»å½•æ–¹å¼
   ```

3. **éƒ¨ç½²**
   ```bash
   vercel --prod
   # æŒ‰æç¤ºæ“ä½œï¼Œé¦–æ¬¡éƒ¨ç½²ä¼šåˆ›å»ºé¡¹ç›®
   ```

---

## âš™ï¸ Vercel é…ç½®æ–‡ä»¶

è™½ç„¶ Vercel å¯ä»¥é›¶é…ç½®è¿è¡Œï¼Œä½†åˆ›å»º `vercel.json` å¯ä»¥è·å¾—æ›´å¤šæ§åˆ¶ï¼š

```json
{
  "version": 2,
  "builds": [
    {
      "src": "package.json",
      "use": "@vercel/next"
    }
  ],
  "routes": [
    {
      "src": "/article/(.*)",
      "dest": "/article/$1.html"
    },
    {
      "src": "/(.*)",
      "dest": "/$1.html"
    }
  ]
}
```

### é…ç½®è¯´æ˜
- `version`: é…ç½®æ–‡ä»¶ç‰ˆæœ¬ï¼ˆå»ºè®®ä½¿ç”¨ 2ï¼‰
- `builds`: æ„å»ºé…ç½®ï¼Œä½¿ç”¨å®˜æ–¹ Next.js builder
- `routes`: è·¯ç”±è§„åˆ™ï¼Œå¤„ç†é™æ€é¡µé¢è·¯ç”±

---

## ğŸŒ ç¯å¢ƒå˜é‡é…ç½®

### 1. åœ¨ Vercel æ§åˆ¶å°é…ç½®

1. è¿›å…¥é¡¹ç›®è®¾ç½®
2. ç‚¹å‡» "Environment Variables"
3. æ·»åŠ å˜é‡ï¼š
   ```
   NEXT_PUBLIC_SITE_URL=https://your-domain.com
   NEXT_PUBLIC_GA_ID=G-XXXXXXXXXX
   ```

### 2. ä½¿ç”¨ `.env.local`ï¼ˆæœ¬åœ°å¼€å‘ï¼‰

åˆ›å»º `.env.local`ï¼š
```env
NEXT_PUBLIC_SITE_URL=http://localhost:3000
NEXT_PUBLIC_GA_ID=G-XXXXXXXXXX
```

### ç¯å¢ƒå˜é‡å‘½åè§„åˆ™
- `NEXT_PUBLIC_*`: å®¢æˆ·ç«¯å¯è®¿é—®
- å…¶ä»–å˜é‡ï¼šä»…æœåŠ¡ç«¯å¯è®¿é—®

---

## ğŸ”§ è‡ªå®šä¹‰åŸŸåé…ç½®

### æ­¥éª¤ 1ï¼šæ·»åŠ åŸŸå

1. è¿›å…¥é¡¹ç›®è®¾ç½®
2. ç‚¹å‡» "Domains"
3. è¾“å…¥åŸŸåï¼ˆå¦‚ `blog.example.com`ï¼‰
4. ç‚¹å‡» "Add"

### æ­¥éª¤ 2ï¼šé…ç½® DNS

#### æ–¹å¼ä¸€ï¼šæ¨èï¼ˆCNAMEï¼‰
```
Type: CNAME
Name: blog
Value: cname.vercel-dns.com
TTL: 300
```

#### æ–¹å¼äºŒï¼šA è®°å½•ï¼ˆæ ¹åŸŸåï¼‰
```
Type: A
Name: @
Value: 76.76.19.19
TTL: 300
```

### æ­¥éª¤ 3ï¼šéªŒè¯

ç­‰å¾… DNS ä¼ æ’­ï¼ˆé€šå¸¸ 5-30 åˆ†é’Ÿï¼‰ï¼Œç„¶åï¼š
- æ£€æŸ¥åŸŸåæ˜¯å¦å¯è®¿é—®
- éªŒè¯ HTTPS è¯ä¹¦
- æµ‹è¯•æ‰€æœ‰é¡µé¢è·¯ç”±

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–è®¾ç½®

### 1. æ„å»ºä¼˜åŒ–

åœ¨ `next.config.ts` ä¸­æ·»åŠ ï¼š
```typescript
const nextConfig = {
  // å¯ç”¨å‹ç¼©
  compress: true,

  // ä¼˜åŒ–å›¾ç‰‡
  images: {
    domains: ['example.com'],
    formats: ['image/webp', 'image/avif'],
  },

  // å¯ç”¨å®éªŒæ€§åŠŸèƒ½
  experimental: {
    optimizePackageImports: ['@heroicons/react'],
    scrollRestoration: true,
  },
};
```

### 2. ç¼“å­˜ç­–ç•¥

Vercel è‡ªåŠ¨ç¼“å­˜ï¼š
- é™æ€èµ„æºï¼š1 å¹´
- HTML é¡µé¢ï¼šæ ¹æ®ç¼“å­˜å¤´
- API è·¯ç”±ï¼šé»˜è®¤ä¸ç¼“å­˜

### 3. è¾¹ç¼˜å‡½æ•°ï¼ˆå¯é€‰ï¼‰

åˆ›å»º `api/edge-function.ts`ï¼š
```typescript
export const config = {
  runtime: 'edge',
};

export default function handler(request: Request) {
  return new Response('Hello from Edge!');
}
```

---

## ğŸ” åˆ†æä¸ç›‘æ§

### 1. Vercel Analytics

å¯ç”¨è®¿é—®ç»Ÿè®¡ï¼š
```bash
npm install @vercel/analytics
```

åœ¨ `app/layout.tsx`ï¼š
```typescript
import { Analytics } from '@vercel/analytics/react';

export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        {children}
        <Analytics />
      </body>
    </html>
  );
}
```

### 2. Speed Insights

è‡ªåŠ¨æ”¶é›† Web Vitalsï¼š
```bash
npm install @vercel/speed-insights
```

åœ¨ `app/layout.tsx`ï¼š
```typescript
import { SpeedInsights } from '@vercel/speed-insights/next';

export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        {children}
        <SpeedInsights />
      </body>
    </html>
  );
}
```

### 3. æŸ¥çœ‹æ•°æ®

1. è¿›å…¥ Vercel é¡¹ç›®
2. ç‚¹å‡» "Analytics" æ ‡ç­¾
3. æŸ¥çœ‹è®¿é—®é‡ã€æ€§èƒ½æŒ‡æ ‡ã€é”™è¯¯ç‡

---

## ğŸ”„ éƒ¨ç½²å·¥ä½œæµ

### ä¸»åˆ†æ”¯éƒ¨ç½²
- è‡ªåŠ¨éƒ¨ç½² `main` åˆ†æ”¯çš„æ¯æ¬¡æ¨é€
- ç”Ÿäº§ç¯å¢ƒæ›´æ–°

### é¢„è§ˆéƒ¨ç½²
- æ¯ä¸ª PR è‡ªåŠ¨ç”Ÿæˆé¢„è§ˆé“¾æ¥
- æ–¹ä¾¿ä»£ç å®¡æŸ¥å’Œæµ‹è¯•

### åˆ†æ”¯ä¿æŠ¤
```json
{
  "git": {
    "deploymentEnabled": {
      "main": true,
      "dev": false
    }
  }
}
```

---

## ğŸ› ï¸ å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜ 1ï¼šæ„å»ºå¤±è´¥

**åŸå› **ï¼šNode.js ç‰ˆæœ¬ä¸åŒ¹é…
```json
// åœ¨ package.json ä¸­æŒ‡å®š
{
  "engines": {
    "node": ">=18.0.0"
  }
}
```

### é—®é¢˜ 2ï¼šè·¯ç”± 404

**è§£å†³æ–¹æ¡ˆ**ï¼šç¡®ä¿ `next.config.ts` æ­£ç¡®é…ç½®ï¼š
```typescript
const nextConfig = {
  output: 'export',
  trailingSlash: true,
  images: {
    unoptimized: true
  }
};
```

### é—®é¢˜ 3ï¼šæ ·å¼ä¸æ­£ç¡®

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥ Tailwind é…ç½®
2. ç¡®è®¤æ„å»ºå‘½ä»¤æ­£ç¡®
3. æŸ¥çœ‹æ„å»ºæ—¥å¿—é”™è¯¯

### é—®é¢˜ 4ï¼šç¯å¢ƒå˜é‡ä¸ç”Ÿæ•ˆ

**æ³¨æ„äº‹é¡¹**ï¼š
- ç¡®ä¿å˜é‡åä»¥ `NEXT_PUBLIC_` å¼€å¤´ï¼ˆå®¢æˆ·ç«¯ï¼‰
- éƒ¨ç½²åé‡æ–°æ„å»º
- æ£€æŸ¥å˜é‡å€¼æ˜¯å¦æ­£ç¡®

---

## ğŸ’° æˆæœ¬ä¼˜åŒ–å»ºè®®

### å…è´¹å¥—é¤æœ€ä½³å®è·µ

1. **ä¼˜åŒ–å›¾ç‰‡**ï¼šä½¿ç”¨ WebP å’Œ AVIF æ ¼å¼
2. **ä»£ç åˆ†å‰²**ï¼šæ‡’åŠ è½½éå…³é”®ä»£ç 
3. **ç¼“å­˜åˆ©ç”¨**ï¼šåˆç†è®¾ç½®ç¼“å­˜å¤´
4. **Bundle åˆ†æ**ï¼š
   ```bash
   npm install @next/bundle-analyzer
   npm run analyze
   ```

### å‡çº§æ—¶æœº

- è¶…è¿‡ 100GB å¸¦å®½
- éœ€è¦æ›´å¤šæ„å»ºæ¬¡æ•°
- éœ€è¦è¾¹ç¼˜å‡½æ•°
- éœ€è¦å›¢é˜Ÿåä½œåŠŸèƒ½

---

## ğŸ“š è¿›é˜¶åŠŸèƒ½

### 1. å¤šç¯å¢ƒéƒ¨ç½²

ä½¿ç”¨åˆ†æ”¯ç®¡ç†ä¸åŒç¯å¢ƒï¼š
- `main` â†’ ç”Ÿäº§ç¯å¢ƒ
- `staging` â†’ é¢„å‘å¸ƒç¯å¢ƒ
- `dev` â†’ å¼€å‘ç¯å¢ƒ

### 2. è‡ªå®šä¹‰ 404 é¡µé¢

åˆ›å»º `pages/404.js`ï¼š
```typescript
export default function Custom404() {
  return <h1>404 - Page Not Found</h1>;
}
```

### 3. ä¸­é—´ä»¶ä½¿ç”¨

åˆ›å»º `middleware.ts`ï¼š
```typescript
import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

export function middleware(request: NextRequest) {
  // é‡å®šå‘é€»è¾‘
  if (request.nextUrl.pathname === '/home') {
    return NextResponse.redirect(new URL('/', request.url));
  }
}
```

### 4. A/B æµ‹è¯•

ä½¿ç”¨ Vercel Edge Configï¼š
```typescript
import { get } from '@vercel/edge-config';

export default async function handler(req) {
  const config = await get('feature-flag');
  // æ ¹æ® config è¿”å›ä¸åŒå†…å®¹
}
```

---

## ğŸ”— æœ‰ç”¨é“¾æ¥

- [Vercel æ–‡æ¡£](https://vercel.com/docs)
- [Next.js éƒ¨ç½²æŒ‡å—](https://nextjs.org/docs/deploying)
- [Vercel å®šä»·](https://vercel.com/pricing)
- [æ€§èƒ½ä¼˜åŒ–æŒ‡å—](https://vercel.com/docs/concepts/functions/edge-functions)

---

**æ›´æ–°æ—¶é—´**ï¼š2025-12-13
**é¡¹ç›®**ï¼šHalavah's Tech
**æ¡†æ¶**ï¼šNext.js 15.5.9
**éƒ¨ç½²æ¨¡å¼**ï¼šStandard Vercel Deployment (éé™æ€å¯¼å‡º)