# Open CoreUI - Rust重写的轻量级Open WebUI

> 使用Rust重写的轻量级Open WebUI服务端和桌面客户端，显著减少内存和资源占用，无需Docker和依赖服务，提供更高效的AI交互界面

## 目录导航

1. [什么是 Open CoreUI？](#1-什么是-open-coreui)
2. [核心优势](#2-核心优势)
3. [系统架构](#3-系统架构)
4. [安装指南](#4-安装指南)
5. [使用方法](#5-使用方法)
6. [配置说明](#6-配置说明)
7. [技术规格](#7-技术规格)
8. [故障排除](#8-故障排除)

## 1. 什么是 Open CoreUI？

Open CoreUI 是一个基于 Rust 语言重写的 Open WebUI 项目，旨在提供一个更加轻量级、高性能的 AI 交互界面。相比于原版 Open WebUI，Open CoreUI 在保持功能完整性的同时，大幅减少了系统资源占用，并简化了部署流程。

### 核心价值

- **极致性能**：Rust 语言带来的零成本抽象和内存安全
- **轻量级设计**：显著减少内存和 CPU 占用
- **简化部署**：无需 Docker 和复杂的依赖服务
- **跨平台支持**：服务端和桌面客户端双重支持
- **开源生态**：完全开源，社区驱动发展

### 项目目标

Open CoreUI 专注于解决原版 Open WebUI 的几个痛点：
1. **高资源消耗**：原版需要大量内存和 CPU 资源
2. **复杂部署**：依赖 Docker 和多个服务组件
3. **启动缓慢**：应用启动和响应速度较慢
4. **维护复杂**：系统依赖关系复杂，维护成本高

## 2. 核心优势

### 🚀 性能优势

#### 内存使用优化
- **原版 Open WebUI**：通常占用 500MB-2GB 内存
- **Open CoreUI**：仅需 50MB-200MB 内存
- **优化比例**：内存占用减少 80-90%

#### 启动速度提升
- **冷启动时间**：从 10-30 秒减少到 2-5 秒
- **热启动时间**：从 3-10 秒减少到 1 秒以内
- **响应速度**：API 响应时间提升 50-70%

#### CPU 使用优化
- **空闲状态**：CPU 占用率 < 1%
- **高负载状态**：CPU 占用率比原版低 60-80%
- **并发处理**：更好的并发性能和资源利用率

### 🛠️ 部署优势

#### 简化部署流程
```bash
# 原版 Open WebUI 部署
docker run -d -p 3000:8080 --add-host=host.docker.internal:host-gateway -v open-webui:/app/backend/data --name open-webui --restart always ghcr.io/open-webui/open-webui:main

# Open CoreUI 部署
./open-coreui-server
```

#### 无依赖要求
- **无需 Docker**：直接运行二进制文件
- **无需数据库**：使用嵌入式数据库
- **无需 Redis**：内置缓存机制
- **无需反向代理**：内置 HTTP 服务器

### 🎯 功能优势

#### 完整功能保持
- ✅ 所有原版 Open WebUI 功能
- ✅ 模型管理和切换
- ✅ 聊天历史记录
- ✅ 文件上传处理
- ✅ 用户管理系统

#### 新增功能
- 🆕 桌面客户端（基于 Tauri）
- 🆕 插件系统支持
- 🆕 更好的主题定制
- 🆕 实时性能监控

## 3. 系统架构

### 技术栈对比

#### 原版 Open WebUI
```
Frontend: React + TypeScript + Tailwind CSS
Backend: Python + FastAPI
Database: PostgreSQL/SQLite
Cache: Redis
Container: Docker
```

#### Open CoreUI
```
Frontend: React + TypeScript + Tailwind CSS
Backend: Rust + Actix-web/Axum
Database: SQLite (嵌入式)
Cache: 内存缓存 (内置)
Desktop: Tauri
```

### 架构设计

#### 服务端架构
```rust
// 主要模块结构
src/
├── main.rs              // 应用入口点
├── config/              // 配置管理
├── models/              // 数据模型
├── handlers/            // HTTP 处理器
├── services/            // 业务逻辑
├── database/            // 数据库操作
├── auth/                // 认证授权
├── api/                 // API 路由
└── utils/               // 工具函数
```

#### 桌面客户端架构
```rust
// Tauri 应用结构
src-tauri/
├── src/
│   ├── main.rs          // Tauri 主程序
│   ├── commands.rs      // 前端调用的命令
│   └── menu.rs          // 应用菜单
├── tauri.conf.json      // Tauri 配置
└── Cargo.toml           // Rust 依赖
```

### 数据流设计

```
用户请求 -> Tauri Frontend -> Rust Backend -> SQLite Database
    ^                                                    |
    |                                                    v
    ---------------------- 响应 <----------------------
```

## 4. 安装指南

### 4.1 系统要求

#### 最低要求
- **操作系统**：Windows 10+, macOS 10.15+, Ubuntu 18.04+
- **处理器**：64位 CPU
- **内存**：2GB RAM
- **存储空间**：100MB 可用空间
- **网络**：互联网连接（用于模型 API）

#### 推荐配置
- **操作系统**：Windows 11, macOS 12+, Ubuntu 20.04+
- **处理器**：多核 64位 CPU
- **内存**：4GB RAM 或更多
- **存储空间**：500MB 可用空间
- **网络**：稳定的宽带连接

### 4.2 安装方式

#### 方式1：预编译二进制文件

##### 服务端安装
```bash
# Linux/macOS
curl -L https://github.com/xxnuo/open-coreui/releases/latest/download/open-coreui-server-linux-x64.tar.gz | tar xz
sudo mv open-coreui-server /usr/local/bin/

# Windows
# 下载 open-coreui-server-windows-x64.zip 并解压
# 将 open-coreui-server.exe 放到 PATH 目录
```

##### 桌面客户端安装
```bash
# macOS
curl -L https://github.com/xxnuo/open-coreui/releases/latest/download/Open.CoreUI.dmg -o Open.CoreUI.dmg
open Open.CoreUI.dmg

# Windows
# 下载 Open.CoreUI.Setup.exe 并运行

# Linux
curl -L https://github.com/xxnuo/open-coreui/releases/latest/download/open-coreui-app.AppImage -o open-coreui-app.AppImage
chmod +x open-coreui-app.AppImage
./open-coreui-app.AppImage
```

#### 方式2：包管理器安装

##### Homebrew (macOS)
```bash
# 添加 tap
brew tap xxnuo/open-coreui

# 安装服务端
brew install open-coreui-server

# 安装桌面客户端
brew install --cask open-coreui-app
```

##### Cargo (Rust 生态系统)
```bash
# 安装服务端
cargo install open-coreui-server

# 安装桌面客户端
cargo install open-coreui-app
```

#### 方式3：源码编译

##### 前置要求
- Rust 1.70.0+
- Node.js 16.0+
- npm/yarn

##### 编译服务端
```bash
# 克隆仓库
git clone https://github.com/xxnuo/open-coreui.git
cd open-coreui

# 编译服务端
cargo build --release

# 运行服务端
./target/release/open-coreui-server
```

##### 编译桌面客户端
```bash
# 安装前端依赖
cd frontend
npm install
npm run build

# 编译桌面应用
cd ../src-tauri
cargo tauri build
```

### 4.3 验证安装

#### 服务端验证
```bash
# 检查版本
open-coreui-server --version

# 启动服务
open-coreui-server

# 访问 Web 界面
curl http://localhost:3000
```

#### 桌面客户端验证
- 启动桌面应用
- 检查界面是否正常显示
- 测试基本功能

## 5. 使用方法

### 5.1 服务端使用

#### 基础启动
```bash
# 使用默认配置启动
open-coreui-server

# 指定端口启动
open-coreui-server --port 8080

# 指定配置文件启动
open-coreui-server --config /path/to/config.toml
```

#### 配置文件示例
```toml
[server]
host = "0.0.0.0"
port = 3000
workers = 4

[database]
path = "./data/open-coreui.db"
backup_interval = 3600  # 秒

[auth]
secret_key = "your-secret-key"
session_timeout = 86400  # 秒

[models]
default_provider = "openai"
api_timeout = 30  # 秒

[cache]
max_size = 1000
ttl = 3600  # 秒
```

#### 环境变量配置
```bash
export OPEN_COREUI_PORT=3000
export OPEN_COREUI_HOST=0.0.0.0
export OPEN_COREUI_DB_PATH=./data.db
export OPEN_COREUI_SECRET_KEY=your-secret-key
export OPEN_COREUI_LOG_LEVEL=info
```

### 5.2 桌面客户端使用

#### 首次启动配置
1. **启动应用**
   - 双击桌面图标或从命令行启动
   - 欢迎界面会引导用户进行初始配置

2. **配置模型 API**
   - 设置 OpenAI API 密钥
   - 或配置其他兼容的 API 端点
   - 测试连接确保配置正确

3. **个性化设置**
   - 选择界面主题
   - 配置语言偏好
   - 设置聊天默认参数

#### 主要功能使用

##### 聊天界面
- **新建对话**：点击"新建对话"按钮
- **模型切换**：从下拉菜单选择不同模型
- **文件上传**：拖拽文件到聊天区域
- **历史记录**：在侧边栏查看历史对话

##### 模型管理
- **添加模型**：在设置页面添加新的 API 端点
- **参数配置**：调整温度、最大令牌数等参数
- **性能测试**：测试不同模型的响应速度

##### 主题定制
- **内置主题**：选择浅色、深色或自动主题
- **自定义主题**：上传自定义 CSS 文件
- **字体设置**：调整界面字体大小和样式

### 5.3 高级功能

#### 插件系统
```rust
// 插件开发示例
use open_coreui::prelude::*;

pub struct MyPlugin;

impl Plugin for MyPlugin {
    fn name(&self) -> &str {
        "My Custom Plugin"
    }

    fn version(&self) -> &str {
        "1.0.0"
    }

    fn on_message(&self, message: &Message) -> Result<Message, Error> {
        // 处理消息逻辑
        Ok(message.clone())
    }
}
```

#### API 扩展
```rust
// 自定义 API 端点
#[get("/custom/endpoint")]
async fn custom_endpoint() -> impl Responder {
    HttpResponse::Ok().json(json!({
        "message": "Hello from custom endpoint"
    }))
}
```

## 6. 配置说明

### 6.1 服务器配置

#### 网络配置
```toml
[server]
host = "0.0.0.0"           # 绑定地址
port = 3000                # 监听端口
workers = 4                # 工作线程数
max_connections = 1000     # 最大连接数
timeout = 30               # 请求超时时间（秒）
```

#### 数据库配置
```toml
[database]
type = "sqlite"            # 数据库类型
path = "./data/app.db"     # 数据库文件路径
max_connections = 10       # 最大连接数
connection_timeout = 30    # 连接超时时间
backup_enabled = true      # 是否启用自动备份
backup_interval = 3600     # 备份间隔（秒）
backup_path = "./backups"  # 备份目录
```

#### 认证配置
```toml
[auth]
enabled = true             # 是否启用认证
secret_key = "your-secret-key"  # JWT 密钥
session_timeout = 86400    # 会话超时时间（秒）
max_login_attempts = 5     # 最大登录尝试次数
lockout_duration = 300     # 账户锁定时间（秒）
```

### 6.2 模型配置

#### OpenAI 配置
```toml
[models.openai]
api_key = "sk-..."         # API 密钥
base_url = "https://api.openai.com/v1"  # API 基础 URL
timeout = 30               # 请求超时时间
max_retries = 3            # 最大重试次数

[models.openai.defaults]
model = "gpt-3.5-turbo"    # 默认模型
temperature = 0.7          # 温度参数
max_tokens = 2048          # 最大令牌数
top_p = 1.0                # top-p 参数
```

#### 本地模型配置
```toml
[models.local]
provider = "ollama"
base_url = "http://localhost:11434"
timeout = 60
max_retries = 1

[models.local.defaults]
model = "llama2"
temperature = 0.7
max_tokens = 2048
```

### 6.3 性能优化配置

#### 缓存配置
```toml
[cache]
enabled = true             # 是否启用缓存
type = "memory"            # 缓存类型：memory, redis
max_size = 1000            # 最大缓存条目数
ttl = 3600                 # 缓存过期时间（秒）
cleanup_interval = 300     # 清理间隔（秒）
```

#### 并发配置
```toml
[concurrency]
max_concurrent_requests = 100  # 最大并发请求数
request_queue_size = 1000      # 请求队列大小
worker_pool_size = 8          # 工作线程池大小
```

## 7. 技术规格

### 版本信息
- **当前版本**: v1.2.0
- **开发语言**: Rust, TypeScript, React
- **桌面框架**: Tauri
- **Web框架**: Actix-web
- **数据库**: SQLite
- **许可证**: MIT License

### 性能指标

#### 内存使用对比
| 组件 | 原版 Open WebUI | Open CoreUI | 优化比例 |
|------|----------------|-------------|----------|
| 基础内存 | 500MB | 50MB | 90% |
| 峰值内存 | 2GB | 200MB | 90% |
| 内存增长 | 100MB/小时 | 10MB/小时 | 90% |

#### 响应时间对比
| 操作类型 | 原版 | Open CoreUI | 提升 |
|----------|------|-------------|------|
| 页面加载 | 3-5秒 | 0.5-1秒 | 70-80% |
| API响应 | 500ms | 150ms | 70% |
| 文件上传 | 10秒 | 2秒 | 80% |

#### 吞吐量对比
| 指标 | 原版 | Open CoreUI | 提升 |
|------|------|-------------|------|
| 并发用户 | 100 | 500 | 400% |
| 请求/秒 | 50 | 300 | 500% |
| 文件处理 | 10个/分钟 | 50个/分钟 | 400% |

### 安全特性
- **内存安全**：Rust 的所有权系统防止内存泄漏
- **类型安全**：编译时类型检查减少运行时错误
- **输入验证**：严格的输入验证和清理
- **认证授权**：基于 JWT 的安全认证机制
- **加密存储**：敏感数据加密存储

### 兼容性
- **OpenAI API**: 完全兼容
- **Ollama**: 完全支持
- **自定义API**: 支持标准 OpenAI 兼容格式
- **浏览器**: Chrome 90+, Firefox 88+, Safari 14+

## 8. 故障排除

### 常见问题

#### 1. 服务端启动失败
```bash
# 检查端口占用
lsof -i :3000

# 检查配置文件
open-coreui-server --config-check

# 查看详细日志
RUST_LOG=debug open-coreui-server
```

#### 2. 数据库连接问题
```bash
# 检查数据库文件权限
ls -la ./data/app.db

# 重新初始化数据库
open-coreui-server --init-db

# 数据库修复
sqlite3 ./data/app.db "PRAGMA integrity_check;"
```

#### 3. 桌面客户端无法启动
```bash
# macOS
xattr -d com.apple.quarantine Open.CoreUI.app

# Linux
chmod +x open-coreui-app.AppImage

# Windows
# 以管理员身份运行安装程序
```

#### 4. API 连接失败
- 检查网络连接
- 验证 API 密钥
- 确认防火墙设置
- 查看错误日志

### 调试模式

#### 启用详细日志
```bash
# 设置日志级别
export RUST_LOG=debug

# 启动服务端
open-coreui-server

# 查看日志
tail -f /var/log/open-coreui/app.log
```

#### 性能分析
```bash
# CPU 性能分析
perf record ./open-coreui-server
perf report

# 内存分析
valgrind --tool=massif ./open-coreui-server
```

### 备份和恢复

#### 数据备份
```bash
# 备份数据库
cp ./data/app.db ./backups/app-$(date +%Y%m%d-%H%M%S).db

# 备份配置
cp config.toml ./backups/config-$(date +%Y%m%d-%H%M%S).toml
```

#### 数据恢复
```bash
# 恢复数据库
cp ./backups/app-20240101-120000.db ./data/app.db

# 恢复配置
cp ./backups/config-20240101-120000.toml config.toml
```

## 更新日志

### v1.2.0 (最新)
- 🚀 性能提升 30%，内存占用进一步优化
- ✨ 新增插件系统支持
- 🔧 改进配置文件热重载
- 🐛 修复桌面客户端崩溃问题

### v1.1.0
- 🎨 全新用户界面设计
- 📱 响应式布局优化
- 🔍 增强的搜索功能
- 🌙 深色主题支持

### v1.0.0
- 🎉 首个稳定版本发布
- ⚡ 基础功能完整实现
- 🔧 配置系统完善
- 📚 完整文档编写

### v0.9.0
- 🧪 Beta 版本发布
- 🧪 功能测试和优化
- 🐛 Bug 修复和改进
- 🔧 性能调优

## 贡献指南

欢迎为 Open CoreUI 项目贡献代码！

### 开发环境设置
```bash
# 克隆仓库
git clone https://github.com/xxnuo/open-coreui.git
cd open-coreui

# 安装 Rust 依赖
cargo build

# 安装前端依赖
cd frontend
npm install
npm run dev

# 启动开发服务器
cd ..
cargo run
```

### 代码贡献流程
1. Fork 项目仓库
2. 创建功能分支 (`git checkout -b feature/amazing-feature`)
3. 提交更改 (`git commit -m 'Add some amazing feature'`)
4. 推送到分支 (`git push origin feature/amazing-feature`)
5. 创建 Pull Request

### 问题报告
- 使用 GitHub Issues 报告 bug
- 提供详细的重现步骤
- 包含系统环境信息
- 附上相关的错误日志

## 许可证

本项目采用 MIT 许可证。详情请参阅 [LICENSE](https://github.com/xxnuo/open-coreui/blob/main/LICENSE) 文件。

## 相关资源

- [GitHub 仓库](https://github.com/xxnuo/open-coreui)
- [官方文档](https://open-coreui.docs.com/)
- [Rust 官方网站](https://www.rust-lang.org/)
- [Tauri 框架](https://tauri.app/)
- [Actix-web](https://actix.rs/)

## 致谢

感谢以下开源项目和社区的支持：
- [Open WebUI](https://github.com/open-webui/open-webui) - 原始项目灵感来源
- [Tauri](https://github.com/tauri-apps/tauri) - 桌面应用框架
- [Actix-web](https://github.com/actix/actix-web) - Web 框架
- React 社区 - 前端技术支持

---

> 💡 **提示**: Open CoreUI 是一个社区驱动的开源项目，如果你在使用中遇到问题或有改进建议，欢迎参与讨论和贡献！