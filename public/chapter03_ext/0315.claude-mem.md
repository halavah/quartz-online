# Claude-Mem - Claude Code 持久化记忆系统

> 为 Claude Code 打造的持久化记忆压缩系统，自动捕获会话上下文，让 AI 拥有真正的长期记忆能力

## 目录导航

1. [什么是 Claude-Mem？](#1-什么是-claude-mem)
2. [核心功能特性](#2-核心功能特性)
3. [系统架构](#3-系统架构)
4. [安装指南](#4-安装指南)
5. [配置说明](#5-配置说明)
6. [使用方法](#6-使用方法)
7. [Web界面](#7-web界面)

## 1. 什么是 Claude-Mem？

Claude-Mem 是一个专为 Claude Code 设计的持久化记忆压缩系统，通过自动捕获工具使用观察、生成语义摘要，并将其提供给未来的会话，无缝保留跨会话的上下文。

### 核心价值

- **跨会话持久化**：即使会话结束或重新连接后，Claude 仍能保持对项目的知识连续性
- **智能压缩**：AI 驱动的智能压缩和摘要，确保重要信息不会丢失
- **自动化管理**：无需手动干预，后台透明运行，自动完成所有记忆管理工作

## 2. 核心功能特性

### 持久化记忆
- 分层记忆检索，模拟人类记忆模式
- 索引层、详情层、完美回忆层，智能决策何时获取详细信息
- 跨会话上下文保留，无缝衔接工作流程

### 智能压缩
- AI 驱动的语义摘要生成
- 渐进式信息披露策略
- 记忆权重衰减和时间衰减机制

### 全文搜索
- 支持全文关键词搜索
- 语义搜索功能，理解查询意图
- 智能相关性排序

### Web界面
- 在 http://localhost:37777 实时查看记忆流
- 可视化管理和浏览所有记忆内容
- 记忆统计和分析功能

### 自动化
- 无需手动干预，后台透明运行
- 自动完成所有记忆管理工作
- 智能触发和更新机制

## 3. 系统架构

### 核心组件协同工作

1. **观察捕获器**：自动捕获 Claude Code 的工具使用观察
2. **记忆处理器**：AI 驱动的智能压缩和摘要生成
3. **存储引擎**：高效的持久化存储和检索系统
4. **Web界面**：直观的记忆管理和可视化界面
5. **MCP接口**：标准化的 Model Context Protocol 接口

### 工作流程

```
会话开始 → 自动注入最近的观察作为上下文
     ↓
工具使用 → 自动捕获观察数据
     ↓
智能处理 → AI 压缩生成摘要
     ↓
持久存储 → 分层存储记忆内容
     ↓
会话结束 → 记忆保存完成
```

## 4. 安装指南

### 4.1 插件安装（推荐）

#### 步骤1：添加市场插件

```bash
# 添加官方插件市场
claude plugin marketplace add https://github.com/anthropics/claude-code
```

#### 步骤2：安装插件

```bash
# 安装 Claude-Mem 插件
claude plugin install claude-mem
```

### 4.2 手动安装

#### 克隆仓库

```bash
# 克隆 Claude-Mem 仓库
git clone https://github.com/thedotmack/claude-mem.git

# 进入项目目录
cd claude-mem

# 安装依赖
npm install

# 构建项目
npm run build
```

#### 配置 MCP

创建或编辑 `.claude/settings.json`：

```json
{
  "mcpServers": {
    "claude-mem": {
      "command": "node",
      "args": ["/path/to/claude-mem/dist/index.js"],
      "env": {
        "CLAUDE_MEM_PORT": "37777",
        "CLAUDE_MEM_DB_PATH": "/path/to/.claude-mem.db"
      }
    }
  }
}
```

## 5. 配置说明

### 5.1 基础配置

```json
{
  "mcpServers": {
    "claude-mem": {
      "command": "node",
      "args": ["./dist/index.js"],
      "env": {
        "CLAUDE_MEM_PORT": "37777",
        "CLAUDE_MEM_HOST": "localhost",
        "CLAUDE_MEM_DB_PATH": "./memory.db",
        "CLAUDE_MEM_MAX_TOKENS": "1000",
        "CLAUDE_MEM_COMPRESSION_MODEL": "claude-3-haiku-20240307"
      }
    }
  }
}
```

### 5.2 高级配置

| 配置项 | 描述 | 默认值 |
|--------|------|--------|
| `CLAUDE_MEM_PORT` | Web界面端口 | 37777 |
| `CLAUDE_MEM_HOST` | 服务器主机 | localhost |
| `CLAUDE_MEM_DB_PATH` | 数据库文件路径 | ./memory.db |
| `CLAUDE_MEM_MAX_TOKENS` | 最大Token数量 | 1000 |
| `CLAUDE_MEM_COMPRESSION_MODEL` | 压缩模型 | claude-3-haiku-20240307 |
| `CLAUDE_MEM_RETENTION_DAYS` | 记忆保留天数 | 30 |
| `CLAUDE_MEM_AUTO_SUMMARIZE` | 自动摘要 | true |
| `CLAUDE_MEM_DEBUG` | 调试模式 | false |

## 6. 使用方法

### 6.1 基础使用

Claude-Mem 会在后台自动运行，无需手动操作。当您使用 Claude Code 时：

1. **自动捕获**：系统自动捕获工具使用和重要对话
2. **智能压缩**：AI 自动生成摘要和压缩内容
3. **上下文注入**：新会话开始时自动注入相关记忆
4. **持续更新**：会话过程中持续更新记忆内容

### 6.2 手动管理

通过 MCP 斜线命令可以手动管理记忆：

```bash
# 查看记忆统计
/mcp__claude-mem__stats

# 搜索记忆
/mcp__claude-mem__search "项目架构"

# 导出记忆
/mcp__claude-mem__export

# 清理过期记忆
/mcp__claude-mem__cleanup
```

### 6.3 记忆管理最佳实践

1. **项目初始化**：在项目开始时让 Claude 了解项目背景
2. **重要决策记录**：关键的技术决策和架构选择会被自动记录
3. **上下文保持**：长时间项目开发中保持上下文连续性
4. **定期清理**：定期清理过期和不重要的记忆内容

## 7. Web界面

### 7.1 访问界面

打开浏览器访问：http://localhost:37777

### 7.2 界面功能

#### 记忆流
- 实时查看新的记忆条目
- 按时间线展示记忆内容
- 记忆分类和标签显示

#### 搜索功能
- 关键词搜索
- 语义搜索
- 高级过滤选项

#### 统计分析
- 记忆数量统计
- 记忆类型分布
- 使用趋势分析

#### 管理工具
- 手动添加记忆
- 编辑现有记忆
- 删除不需要的记忆
- 导入/导出功能

### 7.3 API接口

Web界面提供 RESTful API：

```bash
# 获取所有记忆
GET http://localhost:37777/api/memories

# 搜索记忆
GET http://localhost:37777/api/memories/search?q=关键词

# 获取统计信息
GET http://localhost:37777/api/stats
```

## 技术规格

### 版本信息
- **当前版本**: v7.3
- **开发语言**: TypeScript
- **许可证**: AGPL-3.0

### 系统要求
- Node.js 16+
- Claude Code 最新版本
- 至少 100MB 可用磁盘空间

### 性能特性
- 低延迟记忆捕获
- 高效的压缩算法
- 可扩展的存储架构
- 优化的搜索索引

## 故障排除

### 常见问题

#### 1. 插件安装失败
```bash
# 检查 Claude Code 版本
claude --version

# 更新到最新版本
claude update

# 重新安装插件
claude plugin uninstall claude-mem
claude plugin install claude-mem
```

#### 2. Web界面无法访问
```bash
# 检查端口占用
lsof -i :37777

# 修改配置文件中的端口
export CLAUDE_MEM_PORT=8080
```

#### 3. 记忆数据丢失
```bash
# 检查数据库文件路径
ls -la ~/.claude-mem.db

# 备份现有数据
cp ~/.claude-mem.db ~/.claude-mem.db.backup
```

### 调试模式

启用调试模式获取详细日志：

```json
{
  "mcpServers": {
    "claude-mem": {
      "command": "node",
      "args": ["./dist/index.js"],
      "env": {
        "CLAUDE_MEM_DEBUG": "true",
        "CLAUDE_MEM_LOG_LEVEL": "debug"
      }
    }
  }
}
```

## 更新日志

### v7.3 (最新)
- 改进记忆压缩算法
- 增强语义搜索功能
- 优化 Web 界面性能
- 修复若干已知问题

### 历史版本
详细的更新日志请参考 [GitHub Releases](https://github.com/thedotmack/claude-mem/releases)。

## 贡献指南

欢迎贡献代码！请遵循以下步骤：

1. Fork 项目
2. 创建功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 打开 Pull Request

## 许可证

本项目采用 AGPL-3.0 许可证。详情请参阅 [LICENSE](https://github.com/thedotmack/claude-mem/blob/main/LICENSE) 文件。

## 相关资源

- [GitHub 仓库](https://github.com/thedotmack/claude-mem)
- [Claude Code 官方文档](https://docs.anthropic.com/claude/docs/claude-code)
- [MCP 协议规范](https://modelcontextprotocol.io/)
- [插件开发指南](https://docs.anthropic.com/claude/docs/claude-code/plugins)

## 致谢

感谢所有为 Claude-Mem 项目做出贡献的开发者和用户！

---

> 💡 **提示**: Claude-Mem 是一个开源项目，如果你觉得有用，请考虑给项目一个 Star，或者参与贡献代码！